-------------------- Preparing data... --------------------

Processing patient p10...
Processing patient p11...
Processing patient p12...
Processing patient p02...
Processing patient p04...
Processing patient p03...
Data length: 155562
Split config: Train 70.0%, Test 20.0%
Data ids: ['p10' 'p11' 'p12' 'p02' 'p04' 'p03']
Data processing complete
-------------------- Preparing model... --------------------

Model path: ibm-granite/granite-timeseries-ttm-r2
-------------------- Running few-shot 100% --------------------

Number of params before freezing backbone 805280
Number of params after freezing the backbone 289696
Using learning rate = 0.001
Training for 5 epochs
-------------------- Fine-tuning... --------------------

Starting new training run in output directory: /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-09-30_23-33-09
{'loss': 0.8398, 'grad_norm': 0.37060222029685974, 'learning_rate': 0.000848310779094306, 'epoch': 1.0}
{'eval_loss': 0.8821010589599609, 'eval_runtime': 68.2342, 'eval_samples_per_second': 219.699, 'eval_steps_per_second': 1.729, 'epoch': 1.0}
{'loss': 0.8273, 'grad_norm': 0.3294491171836853, 'learning_rate': 0.0007196311779275895, 'epoch': 2.0}
{'eval_loss': 0.8776744604110718, 'eval_runtime': 70.2685, 'eval_samples_per_second': 213.339, 'eval_steps_per_second': 1.679, 'epoch': 2.0}
{'loss': 0.8215, 'grad_norm': 0.40915408730506897, 'learning_rate': 0.0006104708852083069, 'epoch': 3.0}
{'eval_loss': 0.8776041269302368, 'eval_runtime': 72.4868, 'eval_samples_per_second': 206.81, 'eval_steps_per_second': 1.628, 'epoch': 3.0}
{'loss': 0.8167, 'grad_norm': 0.2936723828315735, 'learning_rate': 0.000517869032245452, 'epoch': 4.0}
{'eval_loss': 0.8754907846450806, 'eval_runtime': 68.673, 'eval_samples_per_second': 218.295, 'eval_steps_per_second': 1.718, 'epoch': 4.0}
{'loss': 0.8127, 'grad_norm': 0.47893649339675903, 'learning_rate': 0.0004393138822129542, 'epoch': 5.0}
{'eval_loss': 0.8756992220878601, 'eval_runtime': 75.1748, 'eval_samples_per_second': 199.415, 'eval_steps_per_second': 1.57, 'epoch': 5.0}
{'train_runtime': 549.058, 'train_samples_per_second': 958.46, 'train_steps_per_second': 14.98, 'train_loss': 0.8235993451985182, 'epoch': 5.0}
[TrackingCallback] Mean Epoch Time = 38.7791344165802 seconds, Total Train Time = 549.0588896274567
-------------------- Evaluating... --------------------

++++++++++++++++++++ Test MSE after few-shot 100% fine-tuning ++++++++++++++++++++
