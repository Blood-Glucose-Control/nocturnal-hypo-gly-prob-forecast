-------------------- Preparing data... -------------------- 

Processing patient p10...
Processing patient p11...
Processing patient p12...
Processing patient p02...
Processing patient p04...
Processing patient p03...
Data length: 155562
Split config: Train 80.0%, Test 20.0%
Data ids: ['p10' 'p11' 'p12' 'p02' 'p04' 'p03']
Data processing complete
-------------------- Preparing model... -------------------- 

Model path: ibm-granite/granite-timeseries-ttm-r2
-------------------- Running few-shot 100% -------------------- 

Number of params before freezing backbone 805280
Number of params after freezing the backbone 289696
Using learning rate = 0.001
Training for 5 epochs
-------------------- Fine-tuning... -------------------- 

Starting new training run in output directory: /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-09-30_23-51-41
{'loss': 0.8408, 'grad_norm': 0.7464385032653809, 'learning_rate': 0.00046994587169476405, 'epoch': 1.0}
{'eval_loss': 0.7640902996063232, 'eval_runtime': 22.1738, 'eval_samples_per_second': 0.271, 'eval_steps_per_second': 0.045, 'epoch': 1.0}
{'loss': 0.8251, 'grad_norm': 0.7251878380775452, 'learning_rate': 0.00022084912232295118, 'epoch': 2.0}
{'eval_loss': 0.768342912197113, 'eval_runtime': 22.3345, 'eval_samples_per_second': 0.269, 'eval_steps_per_second': 0.045, 'epoch': 2.0}
{'loss': 0.8173, 'grad_norm': 1.3710358142852783, 'learning_rate': 0.00010378713330308235, 'epoch': 3.0}
{'eval_loss': 0.7804498076438904, 'eval_runtime': 21.6573, 'eval_samples_per_second': 0.277, 'eval_steps_per_second': 0.046, 'epoch': 3.0}
