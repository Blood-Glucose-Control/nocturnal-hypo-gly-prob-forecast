INFO:p-4074286:t-123229802427456:get_model.py:get_model:Loading model from: ibm-granite/granite-timeseries-ttm-r2
INFO:p-4074286:t-123229802427456:get_model.py:get_model:Model loaded successfully from ibm-granite/granite-timeseries-ttm-r2, revision = main.
INFO:p-4074286:t-123229802427456:get_model.py:get_model:[TTM] context_length = 512, prediction_length = 96
Using auto half precision backend
***** Running training *****
  Num examples = 128,583
  Num Epochs = 5
  Instantaneous batch size per device = 128
  Total train batch size (w. parallel, distributed & accumulation) = 128
  Gradient Accumulation steps = 1
  Total optimization steps = 5,025
  Number of trainable parameters = 289,696
  0%|          | 0/5025 [00:00<?, ?it/s]  0%|          | 1/5025 [01:06<92:53:08, 66.56s/it]                                                     0%|          | 1/5025 [01:06<92:53:08, 66.56s/it]  0%|          | 10/5025 [01:06<6:42:23,  4.81s/it]  0%|          | 19/5025 [01:06<2:53:21,  2.08s/it]  1%|          | 27/5025 [01:06<1:40:51,  1.21s/it]  1%|          | 35/5025 [01:06<1:03:21,  1.31it/s]  1%|          | 43/5025 [01:07<41:34,  2.00it/s]    1%|          | 51/5025 [01:07<28:04,  2.95it/s]  1%|          | 59/5025 [01:07<19:20,  4.28it/s]  1%|▏         | 67/5025 [01:07<13:34,  6.09it/s]  1%|▏         | 75/5025 [01:07<09:40,  8.52it/s]  2%|▏         | 83/5025 [01:07<07:01, 11.72it/s]  2%|▏         | 91/5025 [01:07<05:12, 15.79it/s]  2%|▏         | 99/5025 [01:07<03:57, 20.77it/s]                                                   2%|▏         | 100/5025 [01:07<03:57, 20.77it/s]  2%|▏         | 107/5025 [01:07<03:04, 26.61it/s]  2%|▏         | 115/5025 [01:08<02:28, 33.08it/s]  2%|▏         | 123/5025 [01:08<02:03, 39.84it/s]  3%|▎         | 131/5025 [01:08<01:45, 46.56it/s]  3%|▎         | 139/5025 [01:08<01:32, 52.65it/s]  3%|▎         | 147/5025 [01:08<01:24, 58.02it/s]  3%|▎         | 155/5025 [01:08<01:18, 62.39it/s]  3%|▎         | 163/5025 [01:08<01:14, 65.57it/s]  3%|▎         | 171/5025 [01:08<01:10, 68.38it/s]  4%|▎         | 179/5025 [01:08<01:08, 70.33it/s]  4%|▎         | 187/5025 [01:08<01:07, 71.98it/s]  4%|▍         | 195/5025 [01:09<01:05, 73.30it/s]                                                    4%|▍         | 200/5025 [01:09<01:05, 73.30it/s]  4%|▍         | 203/5025 [01:09<01:04, 74.84it/s]  4%|▍         | 211/5025 [01:09<01:04, 74.38it/s]  4%|▍         | 219/5025 [01:09<01:05, 73.69it/s]  5%|▍         | 227/5025 [01:09<01:05, 73.21it/s]  5%|▍         | 235/5025 [01:09<01:05, 73.10it/s]  5%|▍         | 243/5025 [01:09<01:10, 68.27it/s]  5%|▍         | 250/5025 [01:09<01:12, 65.78it/s]  5%|▌         | 257/5025 [01:10<01:15, 63.11it/s]  5%|▌         | 264/5025 [01:10<01:16, 62.21it/s]  5%|▌         | 271/5025 [01:10<01:17, 61.56it/s]  6%|▌         | 278/5025 [01:10<01:17, 61.22it/s]  6%|▌         | 285/5025 [01:10<01:17, 61.04it/s]  6%|▌         | 292/5025 [01:10<01:18, 60.58it/s]  6%|▌         | 299/5025 [01:10<01:18, 60.33it/s]                                                    6%|▌         | 300/5025 [01:10<01:18, 60.33it/s]  6%|▌         | 306/5025 [01:10<01:18, 60.03it/s]  6%|▌         | 313/5025 [01:10<01:18, 60.05it/s]  6%|▋         | 320/5025 [01:11<01:18, 59.99it/s]  7%|▋         | 327/5025 [01:11<01:18, 59.91it/s]  7%|▋         | 334/5025 [01:11<01:18, 59.93it/s]  7%|▋         | 340/5025 [01:11<01:18, 59.92it/s]  7%|▋         | 346/5025 [01:11<01:18, 59.88it/s]  7%|▋         | 352/5025 [01:11<01:18, 59.70it/s]  7%|▋         | 358/5025 [01:11<01:18, 59.65it/s]  7%|▋         | 364/5025 [01:11<01:18, 59.75it/s]  7%|▋         | 370/5025 [01:11<01:17, 59.73it/s]  8%|▊         | 377/5025 [01:12<01:17, 60.12it/s]  8%|▊         | 384/5025 [01:12<01:16, 60.75it/s]  8%|▊         | 391/5025 [01:12<01:17, 59.84it/s]  8%|▊         | 397/5025 [01:12<01:18, 59.02it/s]                                                    8%|▊         | 400/5025 [01:12<01:18, 59.02it/s]  8%|▊         | 403/5025 [01:12<01:19, 58.31it/s]  8%|▊         | 409/5025 [01:12<01:19, 58.04it/s]  8%|▊         | 416/5025 [01:12<01:17, 59.22it/s]  8%|▊         | 422/5025 [01:12<01:18, 58.57it/s]  9%|▊         | 428/5025 [01:12<01:19, 57.93it/s]  9%|▊         | 434/5025 [01:13<01:20, 57.38it/s]  9%|▉         | 441/5025 [01:13<01:19, 57.57it/s]  9%|▉         | 448/5025 [01:13<01:17, 58.76it/s]  9%|▉         | 454/5025 [01:13<01:18, 58.25it/s]  9%|▉         | 460/5025 [01:13<01:18, 57.92it/s]  9%|▉         | 466/5025 [01:13<01:19, 57.49it/s]  9%|▉         | 473/5025 [01:13<01:18, 57.63it/s] 10%|▉         | 480/5025 [01:13<01:17, 58.92it/s] 10%|▉         | 486/5025 [01:13<01:17, 58.32it/s] 10%|▉         | 492/5025 [01:14<01:18, 57.93it/s] 10%|▉         | 498/5025 [01:14<01:18, 57.50it/s]                                                   10%|▉         | 500/5025 [01:14<01:18, 57.50it/s]
***** Running Evaluation *****
  Num examples = 7213
  Batch size = 128
 10%|▉         | 500/5025 [01:30<01:18, 57.50it/s]
  0%|          | 0/57 [00:00<?, ?it/s][A
 21%|██        | 12/57 [00:00<00:00, 114.59it/s][A
 49%|████▉     | 28/57 [00:00<00:00, 139.73it/s][A
 79%|███████▉  | 45/57 [00:00<00:00, 151.92it/s][ATraceback (most recent call last):
  File "/u6/cjrisi/nocturnal/src/train/ttm.py", line 464, in <module>
    finetune_ttm(
  File "/u6/cjrisi/nocturnal/src/train/ttm.py", line 446, in finetune_ttm
    finetune_forecast_trainer.train()
  File "/u6/cjrisi/nocturnal/.noctprob-venv/lib/python3.11/site-packages/transformers/trainer.py", line 2328, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/u6/cjrisi/nocturnal/.noctprob-venv/lib/python3.11/site-packages/transformers/trainer.py", line 2754, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/u6/cjrisi/nocturnal/.noctprob-venv/lib/python3.11/site-packages/transformers/trainer.py", line 3227, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u6/cjrisi/nocturnal/.noctprob-venv/lib/python3.11/site-packages/transformers/trainer.py", line 3176, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u6/cjrisi/nocturnal/.noctprob-venv/lib/python3.11/site-packages/transformers/trainer.py", line 4469, in evaluate
    output = eval_loop(
             ^^^^^^^^^^
  File "/u6/cjrisi/nocturnal/.noctprob-venv/lib/python3.11/site-packages/transformers/trainer.py", line 4760, in evaluation_loop
    metrics = self.compute_metrics(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/u6/cjrisi/nocturnal/src/train/ttm.py", line 56, in compute_custom_metrics
    if len(predictions.shape) > 2:
           ^^^^^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'shape'
 10%|▉         | 500/5025 [02:15<20:24,  3.70it/s]

                                                [A
