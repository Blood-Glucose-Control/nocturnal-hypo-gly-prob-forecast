Using configuration file: models/configs/ttm_batch_size_performance_limits_experiment.yaml

=== Environment Check ===
Job started at: 2025-10-05 18:32:05 UTC
Job ID: 1354915
Node: watgpu608
Run Directory: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915
Virtual Environment source python path: /u6/cjrisi/nocturnal/.noctprob-venv/bin/python
Python Version: Python 3.11.4
Python internal path check: /u6/cjrisi/nocturnal/.noctprob-venv/bin/python

=== GPU Information ===
Sun Oct  5 18:32:05 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:04:00.0 Off |                    0 |
| N/A   26C    P8             32W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
GPU Driver Version: 575.57.08
GPU Name: NVIDIA L40S
GPU Memory: 46068 MiB
=====================================

=== Model Registry Initialization ===
Registering run in model registry...
Registered run: run_20251005_183159_job1354915

=== GPU Monitoring Log Setup ===
Starting GPU monitoring...
Started GPU monitoring (PID: 49794) and utilization logging (PID: 49795)

=== Starting Training ===
Training started at: 2025-10-05 18:32:07 UTC
Running command:
  python /u6/cjrisi/nocturnal/src/train/ttm_runner.py \
    --run-dir "/u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915"
    --config "/u6/cjrisi/nocturnal/models/configs/ttm_batch_size_performance_limits_experiment.yaml"

INFO: [main] =====================================
INFO: [main] === TTM Runner Starting ===
INFO: [main] Loading configuration from: /u6/cjrisi/nocturnal/models/configs/ttm_batch_size_performance_limits_experiment.yaml
INFO: [main] Configuration saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915/experiment_config.yaml
INFO: [main] =====================================
INFO: [main] === Calling finetune_ttm() ===
INFO: [enhanced_info_print] [main] -------------------- Preparing data... -------------------- 

INFO: [enhanced_info_print] [main] Found 9 processed CSV files in /u6/cjrisi/nocturnal/cache/data/kaggle_brisT1D/processed
INFO: [enhanced_info_print] [main] Loaded p10_full: 25803 rows
INFO: [enhanced_info_print] [main] Loaded p11_full: 25559 rows
INFO: [enhanced_info_print] [main] Loaded p01_full: 8711 rows
INFO: [enhanced_info_print] [main] Loaded p06_full: 8791 rows
INFO: [enhanced_info_print] [main] Loaded p05_full: 8808 rows
INFO: [enhanced_info_print] [main] Loaded p12_full: 26371 rows
INFO: [enhanced_info_print] [main] Loaded p02_full: 26423 rows
INFO: [enhanced_info_print] [main] Loaded p04_full: 24983 rows
INFO: [enhanced_info_print] [main] Loaded p03_full: 26423 rows
INFO: [enhanced_info_print] [main] Successfully loaded 9 patients
INFO: [enhanced_info_print] [main] Processing patient p10_full...
INFO: [enhanced_info_print] [main] Processing patient p11_full...
INFO: [enhanced_info_print] [main] Processing patient p12_full...
INFO: [enhanced_info_print] [main] Processing patient p02_full...
INFO: [enhanced_info_print] [main] Processing patient p04_full...
INFO: [enhanced_info_print] [main] Processing patient p03_full...
INFO: [enhanced_info_print] [main] Data length: 155562
INFO: [enhanced_info_print] [main] Split config: Train 90.0%, Test 10.0%
INFO: [enhanced_info_print] [main] Data ids: ['p10_full' 'p11_full' 'p12_full' 'p02_full' 'p04_full' 'p03_full']
INFO: [enhanced_info_print] [main] Data processing complete
INFO: [enhanced_info_print] [main] -------------------- Preparing model... -------------------- 

INFO: [enhanced_info_print] [main] Model path: ibm-granite/granite-timeseries-ttm-r2
INFO: [enhanced_info_print] [main] -------------------- Running few-shot 100% -------------------- 

2025-10-05T18:32:26 - Loading model from: ibm-granite/granite-timeseries-ttm-r2
2025-10-05T18:32:27 - Model loaded successfully from ibm-granite/granite-timeseries-ttm-r2, revision = main.
2025-10-05T18:32:27 - [TTM] context_length = 512, prediction_length = 96
INFO: [enhanced_info_print] [main] Using learning rate = 0.002
INFO: [enhanced_info_print] [main] Training for 10 epochs
Using auto half precision backend
INFO: [enhanced_info_print] [main] -------------------- Fine-tuning... -------------------- 

INFO: [enhanced_info_print] [main] Starting new training run in output directory: /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26
***** Running training *****
  Num examples = 136,360
  Num Epochs = 10
  Instantaneous batch size per device = 512
  Total train batch size (w. parallel, distributed & accumulation) = 512
  Gradient Accumulation steps = 1
  Total optimization steps = 2,670
  Number of trainable parameters = 289,696
Number of params before freezing backbone 805280
Number of params after freezing the backbone 289696
  0%|          | 0/2670 [00:00<?, ?it/s]  0%|          | 1/2670 [00:18<13:34:16, 18.31s/it]                                                     0%|          | 1/2670 [00:18<13:34:16, 18.31s/it]  0%|          | 8/2670 [00:18<1:14:27,  1.68s/it]   1%|          | 15/2670 [00:18<32:44,  1.35it/s]   1%|          | 22/2670 [00:18<18:26,  2.39it/s]  1%|          | 28/2670 [00:18<12:10,  3.62it/s]  1%|â–         | 34/2670 [00:18<08:20,  5.27it/s]  1%|â–         | 40/2670 [00:18<05:52,  7.46it/s]  2%|â–         | 46/2670 [00:19<04:15, 10.28it/s]  2%|â–         | 52/2670 [00:19<03:10, 13.77it/s]  2%|â–         | 58/2670 [00:19<02:25, 17.93it/s]  2%|â–         | 64/2670 [00:19<02:25, 17.91it/s]  3%|â–Ž         | 69/2670 [00:19<02:00, 21.52it/s]  3%|â–Ž         | 75/2670 [00:19<01:37, 26.56it/s]  3%|â–Ž         | 81/2670 [00:19<01:22, 31.55it/s]  3%|â–Ž         | 87/2670 [00:20<01:10, 36.56it/s]  3%|â–Ž         | 93/2670 [00:20<01:03, 40.81it/s]  4%|â–Ž         | 99/2670 [00:20<00:57, 44.40it/s]                                                   4%|â–Ž         | 100/2670 [00:20<00:57, 44.40it/s]  4%|â–         | 105/2670 [00:20<00:54, 47.30it/s]  4%|â–         | 111/2670 [00:20<00:51, 49.34it/s]  4%|â–         | 117/2670 [00:20<00:50, 50.71it/s]  5%|â–         | 123/2670 [00:20<00:49, 51.71it/s]  5%|â–         | 129/2670 [00:20<00:48, 52.04it/s]  5%|â–Œ         | 135/2670 [00:20<00:47, 52.85it/s]  5%|â–Œ         | 141/2670 [00:21<00:47, 53.30it/s]  6%|â–Œ         | 147/2670 [00:21<00:46, 53.69it/s]  6%|â–Œ         | 153/2670 [00:21<00:46, 53.96it/s]  6%|â–Œ         | 159/2670 [00:21<00:46, 54.09it/s]  6%|â–Œ         | 165/2670 [00:21<00:45, 55.19it/s]  6%|â–‹         | 171/2670 [00:21<00:44, 56.06it/s]  7%|â–‹         | 177/2670 [00:21<00:45, 54.98it/s]  7%|â–‹         | 183/2670 [00:21<00:45, 54.87it/s]  7%|â–‹         | 189/2670 [00:21<00:45, 54.52it/s]  7%|â–‹         | 195/2670 [00:22<00:45, 54.37it/s]                                                    7%|â–‹         | 200/2670 [00:22<00:45, 54.37it/s]  8%|â–Š         | 201/2670 [00:22<00:44, 55.24it/s]  8%|â–Š         | 207/2670 [00:22<00:44, 55.35it/s]  8%|â–Š         | 213/2670 [00:22<00:43, 56.16it/s]  8%|â–Š         | 219/2670 [00:22<00:43, 56.40it/s]  8%|â–Š         | 225/2670 [00:22<00:43, 56.12it/s]  9%|â–Š         | 231/2670 [00:22<00:44, 54.37it/s]  9%|â–‰         | 237/2670 [00:22<00:45, 53.64it/s]  9%|â–‰         | 243/2670 [00:22<00:43, 55.17it/s]  9%|â–‰         | 249/2670 [00:23<00:44, 54.54it/s] 10%|â–‰         | 255/2670 [00:23<00:45, 53.33it/s] 10%|â–‰         | 261/2670 [00:23<00:46, 52.12it/s] 10%|â–ˆ         | 267/2670 [00:24<03:18, 12.08it/s]{'loss': 1.0695, 'grad_norm': 0.7027026414871216, 'learning_rate': 0.002, 'epoch': 0.0, 'timestamp': 1759689166.505808, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8571, 'grad_norm': 0.11555618792772293, 'learning_rate': 0.0019802967070534504, 'epoch': 0.37, 'timestamp': 1759689168.514448, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8339, 'grad_norm': 0.12177251279354095, 'learning_rate': 0.0019605914452309682, 'epoch': 0.75, 'timestamp': 1759689170.3384166, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 10%|â–ˆ         | 267/2670 [00:40<03:18, 12.08it/s] 10%|â–ˆ         | 268/2670 [00:41<46:45,  1.17s/it] 10%|â–ˆ         | 273/2670 [00:41<31:53,  1.25it/s] 10%|â–ˆ         | 278/2670 [00:41<22:03,  1.81it/s] 11%|â–ˆ         | 284/2670 [00:41<14:31,  2.74it/s] 11%|â–ˆ         | 289/2670 [00:41<10:27,  3.80it/s] 11%|â–ˆ         | 294/2670 [00:41<07:35,  5.22it/s] 11%|â–ˆ         | 300/2670 [00:41<05:15,  7.51it/s]                                                   11%|â–ˆ         | 300/2670 [00:41<05:15,  7.51it/s] 11%|â–ˆâ–        | 306/2670 [00:41<03:47, 10.40it/s] 12%|â–ˆâ–        | 312/2670 [00:41<02:49, 13.92it/s] 12%|â–ˆâ–        | 318/2670 [00:41<02:09, 18.13it/s] 12%|â–ˆâ–        | 324/2670 [00:42<01:42, 22.85it/s] 12%|â–ˆâ–        | 330/2670 [00:42<01:25, 27.42it/s] 13%|â–ˆâ–Ž        | 336/2670 [00:42<01:38, 23.69it/s] 13%|â–ˆâ–Ž        | 341/2670 [00:42<01:50, 21.07it/s] 13%|â–ˆâ–Ž        | 346/2670 [00:42<01:33, 24.81it/s] 13%|â–ˆâ–Ž        | 351/2670 [00:43<01:20, 28.66it/s] 13%|â–ˆâ–Ž        | 356/2670 [00:43<01:11, 32.29it/s] 14%|â–ˆâ–Ž        | 361/2670 [00:43<01:05, 35.52it/s] 14%|â–ˆâ–Ž        | 366/2670 [00:43<01:00, 38.24it/s] 14%|â–ˆâ–        | 372/2670 [00:43<00:54, 42.11it/s] 14%|â–ˆâ–        | 378/2670 [00:43<00:49, 46.40it/s] 14%|â–ˆâ–        | 384/2670 [00:43<00:46, 48.94it/s] 15%|â–ˆâ–        | 390/2670 [00:43<00:45, 50.36it/s] 15%|â–ˆâ–        | 396/2670 [00:43<00:45, 49.67it/s]                                                   15%|â–ˆâ–        | 400/2670 [00:44<00:45, 49.67it/s] 15%|â–ˆâ–Œ        | 402/2670 [00:44<00:45, 49.46it/s] 15%|â–ˆâ–Œ        | 408/2670 [00:44<00:44, 50.75it/s] 16%|â–ˆâ–Œ        | 414/2670 [00:44<00:43, 52.09it/s] 16%|â–ˆâ–Œ        | 420/2670 [00:44<00:41, 53.78it/s] 16%|â–ˆâ–Œ        | 426/2670 [00:44<00:40, 55.08it/s] 16%|â–ˆâ–Œ        | 432/2670 [00:44<00:40, 55.69it/s] 16%|â–ˆâ–‹        | 438/2670 [00:44<00:39, 56.60it/s] 17%|â–ˆâ–‹        | 444/2670 [00:44<00:39, 55.82it/s] 17%|â–ˆâ–‹        | 450/2670 [00:44<00:40, 54.63it/s] 17%|â–ˆâ–‹        | 456/2670 [00:45<00:41, 53.65it/s] 17%|â–ˆâ–‹        | 462/2670 [00:45<00:41, 53.46it/s] 18%|â–ˆâ–Š        | 468/2670 [00:45<00:41, 53.06it/s] 18%|â–ˆâ–Š        | 474/2670 [00:45<00:41, 52.52it/s] 18%|â–ˆâ–Š        | 480/2670 [00:45<00:42, 52.09it/s] 18%|â–ˆâ–Š        | 486/2670 [00:45<00:42, 51.89it/s] 18%|â–ˆâ–Š        | 492/2670 [00:45<00:41, 51.87it/s] 19%|â–ˆâ–Š        | 498/2670 [00:45<00:41, 51.76it/s]                                                   19%|â–ˆâ–Š        | 500/2670 [00:45<00:41, 51.76it/s] 19%|â–ˆâ–‰        | 504/2670 [00:45<00:41, 51.71it/s] 19%|â–ˆâ–‰        | 510/2670 [00:46<00:41, 51.58it/s] 19%|â–ˆâ–‰        | 516/2670 [00:46<00:41, 51.79it/s] 20%|â–ˆâ–‰        | 522/2670 [00:46<00:41, 52.03it/s] 20%|â–ˆâ–‰        | 528/2670 [00:46<00:41, 51.91it/s] 20%|â–ˆâ–ˆ        | 534/2670 [00:47<02:36, 13.61it/s]{'loss': 0.8346, 'grad_norm': 0.11232912540435791, 'learning_rate': 0.0019410822637948818, 'epoch': 1.12, 'timestamp': 1759689189.8529353, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8292, 'grad_norm': 0.11284457892179489, 'learning_rate': 0.0019217672116156727, 'epoch': 1.5, 'timestamp': 1759689192.2377832, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8311, 'grad_norm': 0.12233947217464447, 'learning_rate': 0.001902644356978859, 'epoch': 1.87, 'timestamp': 1759689194.1035953, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 20%|â–ˆâ–ˆ        | 534/2670 [01:00<02:36, 13.61it/s] 20%|â–ˆâ–ˆ        | 535/2670 [01:04<41:19,  1.16s/it] 20%|â–ˆâ–ˆ        | 540/2670 [01:04<28:11,  1.26it/s] 20%|â–ˆâ–ˆ        | 545/2670 [01:04<19:29,  1.82it/s] 21%|â–ˆâ–ˆ        | 550/2670 [01:04<13:38,  2.59it/s] 21%|â–ˆâ–ˆ        | 555/2670 [01:04<09:39,  3.65it/s] 21%|â–ˆâ–ˆ        | 560/2670 [01:04<06:55,  5.08it/s] 21%|â–ˆâ–ˆ        | 566/2670 [01:04<04:44,  7.39it/s] 21%|â–ˆâ–ˆâ–       | 572/2670 [01:04<03:23, 10.33it/s] 22%|â–ˆâ–ˆâ–       | 578/2670 [01:04<02:30, 13.87it/s] 22%|â–ˆâ–ˆâ–       | 584/2670 [01:05<01:56, 17.87it/s] 22%|â–ˆâ–ˆâ–       | 590/2670 [01:05<01:31, 22.69it/s] 22%|â–ˆâ–ˆâ–       | 596/2670 [01:05<01:16, 27.16it/s]                                                   22%|â–ˆâ–ˆâ–       | 600/2670 [01:05<01:16, 27.16it/s] 23%|â–ˆâ–ˆâ–Ž       | 602/2670 [01:05<01:32, 22.41it/s] 23%|â–ˆâ–ˆâ–Ž       | 607/2670 [01:05<01:19, 25.93it/s] 23%|â–ˆâ–ˆâ–Ž       | 613/2670 [01:05<01:06, 31.04it/s] 23%|â–ˆâ–ˆâ–Ž       | 619/2670 [01:05<00:57, 35.65it/s] 23%|â–ˆâ–ˆâ–Ž       | 625/2670 [01:06<00:50, 40.20it/s] 24%|â–ˆâ–ˆâ–Ž       | 631/2670 [01:06<00:46, 43.72it/s] 24%|â–ˆâ–ˆâ–       | 637/2670 [01:06<00:43, 46.61it/s] 24%|â–ˆâ–ˆâ–       | 643/2670 [01:06<00:40, 49.47it/s] 24%|â–ˆâ–ˆâ–       | 649/2670 [01:06<00:39, 51.11it/s] 25%|â–ˆâ–ˆâ–       | 655/2670 [01:06<00:38, 52.17it/s] 25%|â–ˆâ–ˆâ–       | 661/2670 [01:06<00:37, 53.31it/s] 25%|â–ˆâ–ˆâ–       | 667/2670 [01:06<00:36, 54.49it/s] 25%|â–ˆâ–ˆâ–Œ       | 673/2670 [01:06<00:36, 54.46it/s] 25%|â–ˆâ–ˆâ–Œ       | 679/2670 [01:07<00:35, 55.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 685/2670 [01:07<00:35, 55.19it/s] 26%|â–ˆâ–ˆâ–Œ       | 691/2670 [01:07<00:35, 55.86it/s] 26%|â–ˆâ–ˆâ–Œ       | 697/2670 [01:07<00:35, 55.48it/s]                                                   26%|â–ˆâ–ˆâ–Œ       | 700/2670 [01:07<00:35, 55.48it/s] 26%|â–ˆâ–ˆâ–‹       | 703/2670 [01:07<00:35, 56.04it/s] 27%|â–ˆâ–ˆâ–‹       | 709/2670 [01:07<00:35, 55.62it/s] 27%|â–ˆâ–ˆâ–‹       | 715/2670 [01:07<00:35, 55.73it/s] 27%|â–ˆâ–ˆâ–‹       | 721/2670 [01:07<00:35, 55.21it/s] 27%|â–ˆâ–ˆâ–‹       | 727/2670 [01:07<00:34, 55.85it/s] 27%|â–ˆâ–ˆâ–‹       | 733/2670 [01:08<00:34, 55.99it/s] 28%|â–ˆâ–ˆâ–Š       | 739/2670 [01:08<00:34, 55.22it/s] 28%|â–ˆâ–ˆâ–Š       | 745/2670 [01:08<00:35, 54.62it/s] 28%|â–ˆâ–ˆâ–Š       | 751/2670 [01:08<00:35, 53.70it/s] 28%|â–ˆâ–ˆâ–Š       | 757/2670 [01:08<00:35, 53.43it/s] 29%|â–ˆâ–ˆâ–Š       | 763/2670 [01:08<00:35, 53.22it/s] 29%|â–ˆâ–ˆâ–‰       | 769/2670 [01:08<00:35, 52.98it/s] 29%|â–ˆâ–ˆâ–‰       | 775/2670 [01:08<00:35, 52.97it/s] 29%|â–ˆâ–ˆâ–‰       | 781/2670 [01:08<00:35, 52.95it/s] 29%|â–ˆâ–ˆâ–‰       | 787/2670 [01:09<00:35, 52.72it/s] 30%|â–ˆâ–ˆâ–‰       | 793/2670 [01:09<00:36, 51.59it/s] 30%|â–ˆâ–ˆâ–‰       | 799/2670 [01:09<00:35, 53.06it/s]                                                   30%|â–ˆâ–ˆâ–‰       | 800/2670 [01:09<00:35, 53.06it/s]{'loss': 0.825, 'grad_norm': 0.12585577368736267, 'learning_rate': 0.0018837117873917895, 'epoch': 2.25, 'timestamp': 1759689213.7839897, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8312, 'grad_norm': 0.138436421751976, 'learning_rate': 0.001864967609392383, 'epoch': 2.62, 'timestamp': 1759689215.6134136, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.828, 'grad_norm': 0.17331357300281525, 'learning_rate': 0.0018464099483597582, 'epoch': 3.0, 'timestamp': 1759689217.4736674, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 30%|â–ˆâ–ˆâ–ˆ       | 801/2670 [01:20<00:35, 53.06it/s] 30%|â–ˆâ–ˆâ–ˆ       | 802/2670 [01:25<30:49,  1.01it/s] 30%|â–ˆâ–ˆâ–ˆ       | 806/2670 [01:25<23:13,  1.34it/s] 30%|â–ˆâ–ˆâ–ˆ       | 811/2670 [01:26<16:12,  1.91it/s] 31%|â–ˆâ–ˆâ–ˆ       | 816/2670 [01:26<11:24,  2.71it/s] 31%|â–ˆâ–ˆâ–ˆ       | 821/2670 [01:26<08:07,  3.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 826/2670 [01:26<05:51,  5.25it/s] 31%|â–ˆâ–ˆâ–ˆ       | 831/2670 [01:26<04:17,  7.15it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 836/2670 [01:26<03:11,  9.59it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 841/2670 [01:26<02:25, 12.54it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 846/2670 [01:26<01:53, 16.02it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 851/2670 [01:26<01:31, 19.78it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 856/2670 [01:27<01:16, 23.81it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 861/2670 [01:27<01:05, 27.66it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 866/2670 [01:27<01:19, 22.72it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 871/2670 [01:27<01:07, 26.50it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 876/2670 [01:27<00:59, 30.11it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 881/2670 [01:27<00:53, 33.14it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 886/2670 [01:27<00:49, 35.88it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 891/2670 [01:28<00:46, 37.86it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 896/2670 [01:28<00:44, 39.58it/s]                                                   34%|â–ˆâ–ˆâ–ˆâ–Ž      | 900/2670 [01:28<00:44, 39.58it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 901/2670 [01:28<00:43, 40.69it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 906/2670 [01:28<00:42, 41.72it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 911/2670 [01:28<00:41, 42.12it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 916/2670 [01:28<00:41, 41.89it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 921/2670 [01:28<00:41, 42.39it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 926/2670 [01:28<00:40, 42.87it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 931/2670 [01:28<00:40, 43.05it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 938/2670 [01:29<00:35, 48.64it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 944/2670 [01:29<00:34, 49.66it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 950/2670 [01:29<00:33, 50.95it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 956/2670 [01:29<00:32, 52.43it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 962/2670 [01:29<00:32, 52.86it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 968/2670 [01:29<00:31, 54.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 974/2670 [01:29<00:31, 53.94it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 980/2670 [01:29<00:30, 54.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 986/2670 [01:29<00:30, 54.36it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 992/2670 [01:30<00:31, 53.31it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 998/2670 [01:30<00:30, 54.22it/s]                                                   37%|â–ˆâ–ˆâ–ˆâ–‹      | 1000/2670 [01:30<00:30, 54.22it/s]
***** Running Evaluation *****
  Num examples = 6
  Batch size = 512
{'loss': 0.8311, 'grad_norm': 0.12821504473686218, 'learning_rate': 0.001828036948326749, 'epoch': 3.37, 'timestamp': 1759689236.4599822, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8217, 'grad_norm': 0.18798241019248962, 'learning_rate': 0.001809846771794291, 'epoch': 3.75, 'timestamp': 1759689238.4333737, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                   
                                     [A 37%|â–ˆâ–ˆâ–ˆâ–‹      | 1000/2670 [01:45<00:30, 54.22it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 508.22it/s][A
                                              [A 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1004/2670 [01:45<22:04,  1.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1009/2670 [01:45<16:22,  1.69it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1015/2670 [01:46<11:25,  2.41it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1021/2670 [01:46<08:03,  3.41it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1026/2670 [01:46<06:02,  4.53it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 1031/2670 [01:46<04:31,  6.04it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1036/2670 [01:46<03:23,  8.01it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1041/2670 [01:46<02:35, 10.51it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1046/2670 [01:46<01:59, 13.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1051/2670 [01:46<01:35, 17.02it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 1057/2670 [01:46<01:13, 21.89it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 1063/2670 [01:47<00:59, 27.17it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1068/2670 [01:48<02:28, 10.81it/s]{'eval_loss': 1.2776600122451782, 'eval_custom_error': 'Cannot extract labels from complex structure', 'eval_runtime': 15.4996, 'eval_samples_per_second': 0.387, 'eval_steps_per_second': 0.065, 'epoch': 3.75, 'timestamp': 1759689253.9338775, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1068/2670 [02:00<02:28, 10.81it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1069/2670 [02:04<34:07,  1.28s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1074/2670 [02:04<22:29,  1.18it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1080/2670 [02:04<14:16,  1.86it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1086/2670 [02:04<09:27,  2.79it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1092/2670 [02:04<06:27,  4.07it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1098/2670 [02:05<04:32,  5.77it/s]                                                    41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1100/2670 [02:05<04:31,  5.77it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1104/2670 [02:05<03:15,  8.01it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1110/2670 [02:05<02:22, 10.91it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1116/2670 [02:05<01:48, 14.37it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1122/2670 [02:05<01:23, 18.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1128/2670 [02:05<01:06, 23.13it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1134/2670 [02:05<00:55, 27.83it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1140/2670 [02:06<01:04, 23.70it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1146/2670 [02:06<00:53, 28.44it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1152/2670 [02:06<00:45, 33.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1158/2670 [02:06<00:39, 38.15it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1164/2670 [02:06<00:35, 42.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1170/2670 [02:06<00:32, 45.77it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1176/2670 [02:06<00:31, 48.19it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1182/2670 [02:06<00:29, 50.79it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1188/2670 [02:06<00:29, 50.94it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1194/2670 [02:07<00:28, 51.71it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1200/2670 [02:07<00:27, 52.75it/s]                                                    45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1200/2670 [02:07<00:27, 52.75it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1206/2670 [02:07<00:27, 53.49it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1212/2670 [02:07<00:26, 54.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1218/2670 [02:07<00:26, 54.97it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1224/2670 [02:07<00:25, 56.18it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1230/2670 [02:07<00:25, 56.06it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1236/2670 [02:07<00:25, 56.93it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1242/2670 [02:07<00:25, 56.40it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1248/2670 [02:07<00:24, 57.22it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1254/2670 [02:08<00:25, 56.57it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1261/2670 [02:08<00:24, 58.09it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1267/2670 [02:08<00:24, 56.79it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1273/2670 [02:08<00:24, 57.47it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1279/2670 [02:08<00:24, 56.73it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1285/2670 [02:08<00:24, 57.28it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1291/2670 [02:08<00:24, 57.08it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1297/2670 [02:08<00:23, 57.34it/s]                                                    49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1300/2670 [02:08<00:23, 57.34it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1303/2670 [02:08<00:24, 56.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1309/2670 [02:09<00:23, 56.85it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1315/2670 [02:09<00:24, 56.41it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1321/2670 [02:09<00:24, 55.75it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1327/2670 [02:09<00:23, 56.08it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1333/2670 [02:09<00:23, 56.49it/s]{'loss': 0.8194, 'grad_norm': 0.20800156891345978, 'learning_rate': 0.001791837599547652, 'epoch': 4.12, 'timestamp': 1759689273.2586107, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8248, 'grad_norm': 0.13796399533748627, 'learning_rate': 0.0017740076304744881, 'epoch': 4.49, 'timestamp': 1759689275.3263056, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8179, 'grad_norm': 0.1777573823928833, 'learning_rate': 0.0017563550813847147, 'epoch': 4.87, 'timestamp': 1759689277.086826, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1335/2670 [02:20<00:23, 56.49it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1336/2670 [02:25<21:39,  1.03it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1340/2670 [02:25<16:18,  1.36it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1347/2670 [02:26<10:05,  2.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1353/2670 [02:26<06:56,  3.16it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1359/2670 [02:26<04:51,  4.49it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1365/2670 [02:26<03:27,  6.29it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1371/2670 [02:26<02:30,  8.64it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1377/2670 [02:26<01:50, 11.66it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1383/2670 [02:26<01:23, 15.37it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1389/2670 [02:26<01:05, 19.59it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1395/2670 [02:26<00:52, 24.36it/s]                                                    52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1400/2670 [02:27<00:52, 24.36it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1401/2670 [02:27<00:57, 21.95it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1406/2670 [02:27<00:49, 25.46it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1411/2670 [02:27<00:43, 28.95it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1417/2670 [02:27<00:36, 34.20it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1423/2670 [02:27<00:31, 39.06it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1429/2670 [02:27<00:28, 43.30it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1435/2670 [02:27<00:26, 46.42it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1441/2670 [02:27<00:24, 49.38it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1447/2670 [02:28<00:23, 51.31it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1453/2670 [02:28<00:23, 52.90it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1459/2670 [02:28<00:22, 54.00it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1465/2670 [02:28<00:21, 55.14it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1471/2670 [02:28<00:21, 55.73it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1477/2670 [02:28<00:21, 56.36it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1483/2670 [02:28<00:21, 56.47it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1489/2670 [02:28<00:20, 56.54it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1495/2670 [02:28<00:20, 56.65it/s]                                                    56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1500/2670 [02:28<00:20, 56.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1501/2670 [02:28<00:20, 56.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1507/2670 [02:29<00:20, 56.84it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1513/2670 [02:29<00:20, 56.88it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1519/2670 [02:29<00:20, 56.78it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1525/2670 [02:29<00:20, 56.89it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1531/2670 [02:29<00:20, 56.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1537/2670 [02:29<00:19, 56.80it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1543/2670 [02:29<00:19, 56.83it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1549/2670 [02:29<00:19, 57.03it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1555/2670 [02:29<00:19, 57.34it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1561/2670 [02:30<00:19, 56.99it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1567/2670 [02:30<00:19, 56.73it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1573/2670 [02:30<00:19, 56.69it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1579/2670 [02:30<00:19, 56.89it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1585/2670 [02:30<00:19, 56.94it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1591/2670 [02:30<00:18, 57.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1597/2670 [02:30<00:18, 56.51it/s]                                                    60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1600/2670 [02:30<00:18, 56.51it/s]{'loss': 0.8239, 'grad_norm': 0.1417623907327652, 'learning_rate': 0.0017388781868321668, 'epoch': 5.24, 'timestamp': 1759689295.367704, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8175, 'grad_norm': 0.12046767771244049, 'learning_rate': 0.0017215751989380385, 'epoch': 5.62, 'timestamp': 1759689297.1731246, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8197, 'grad_norm': 0.16283243894577026, 'learning_rate': 0.0017044443872160726, 'epoch': 5.99, 'timestamp': 1759689298.9305158, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1603/2670 [02:47<15:01,  1.18it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1608/2670 [02:47<11:07,  1.59it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1614/2670 [02:47<07:43,  2.28it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1620/2670 [02:47<05:24,  3.23it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1626/2670 [02:47<03:50,  4.53it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1632/2670 [02:47<02:45,  6.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1638/2670 [02:48<02:01,  8.51it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1644/2670 [02:48<01:29, 11.45it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1650/2670 [02:48<01:08, 14.99it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1656/2670 [02:48<00:53, 18.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1662/2670 [02:48<00:42, 23.57it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1668/2670 [02:48<00:35, 28.22it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1674/2670 [02:48<00:41, 23.89it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1679/2670 [02:49<00:35, 27.60it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1685/2670 [02:49<00:29, 32.87it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1691/2670 [02:49<00:26, 37.23it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1697/2670 [02:49<00:23, 40.94it/s]                                                    64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1700/2670 [02:49<00:23, 40.94it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1703/2670 [02:49<00:21, 44.29it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1709/2670 [02:49<00:20, 46.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1715/2670 [02:49<00:19, 49.40it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1721/2670 [02:49<00:18, 51.04it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1727/2670 [02:49<00:18, 51.81it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1734/2670 [02:50<00:17, 54.86it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1740/2670 [02:50<00:17, 54.48it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1747/2670 [02:50<00:16, 55.43it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1753/2670 [02:50<00:16, 54.42it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1759/2670 [02:50<00:16, 54.57it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1765/2670 [02:50<00:16, 54.80it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1771/2670 [02:50<00:16, 54.98it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1777/2670 [02:50<00:16, 55.16it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1783/2670 [02:50<00:16, 55.36it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1789/2670 [02:51<00:15, 55.33it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1795/2670 [02:51<00:15, 55.64it/s]                                                    67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1800/2670 [02:51<00:15, 55.64it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1801/2670 [02:51<00:15, 54.81it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1807/2670 [02:51<00:15, 54.80it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1813/2670 [02:51<00:15, 54.83it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1819/2670 [02:51<00:15, 54.92it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1825/2670 [02:51<00:15, 55.09it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1831/2670 [02:51<00:15, 55.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1837/2670 [02:51<00:15, 55.36it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1843/2670 [02:51<00:14, 55.34it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1849/2670 [02:52<00:14, 55.43it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1855/2670 [02:52<00:14, 55.64it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1861/2670 [02:52<00:14, 55.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1867/2670 [02:52<00:14, 55.35it/s]{'loss': 0.8181, 'grad_norm': 0.14752233028411865, 'learning_rate': 0.001687484038399493, 'epoch': 6.37, 'timestamp': 1759689317.6086996, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8159, 'grad_norm': 0.2056359052658081, 'learning_rate': 0.0016706924562696636, 'epoch': 6.74, 'timestamp': 1759689319.4152577, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1873/2670 [03:09<11:30,  1.15it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1879/2670 [03:09<08:04,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1885/2670 [03:09<05:40,  2.30it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1891/2670 [03:09<04:00,  3.24it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1897/2670 [03:09<02:51,  4.51it/s]                                                    71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1900/2670 [03:09<02:50,  4.51it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1903/2670 [03:10<02:03,  6.22it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1909/2670 [03:10<01:29,  8.46it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1915/2670 [03:10<01:06, 11.38it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1921/2670 [03:10<00:50, 14.94it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1927/2670 [03:10<00:39, 18.96it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1933/2670 [03:10<00:30, 23.80it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1939/2670 [03:11<00:40, 18.00it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1945/2670 [03:11<00:31, 22.70it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1951/2670 [03:11<00:25, 27.78it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1957/2670 [03:11<00:22, 32.17it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1963/2670 [03:11<00:19, 37.13it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1969/2670 [03:11<00:16, 41.78it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1975/2670 [03:11<00:15, 45.45it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1981/2670 [03:11<00:14, 48.97it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1987/2670 [03:11<00:13, 51.36it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1993/2670 [03:12<00:12, 53.18it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1999/2670 [03:12<00:12, 53.85it/s]                                                    75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 2000/2670 [03:12<00:12, 53.85it/s]
***** Running Evaluation *****
  Num examples = 6
  Batch size = 512
{'loss': 0.8143, 'grad_norm': 0.15787780284881592, 'learning_rate': 0.0016540679614864438, 'epoch': 7.12, 'timestamp': 1759689338.189046, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8084, 'grad_norm': 0.13371087610721588, 'learning_rate': 0.001637608891420239, 'epoch': 7.49, 'timestamp': 1759689340.3789732, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                   
                                     [A 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 2000/2670 [03:27<00:12, 53.85it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 1076.84it/s][A
                                               [ASaving model checkpoint to /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2000
Configuration saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2000/config.json
Model weights saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2000/model.safetensors
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2005/2670 [03:27<08:47,  1.26it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2010/2670 [03:27<06:29,  1.70it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2016/2670 [03:27<04:29,  2.43it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2023/2670 [03:28<02:59,  3.61it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2029/2670 [03:28<02:08,  4.99it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2035/2670 [03:28<01:33,  6.82it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2042/2670 [03:28<01:04,  9.68it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2048/2670 [03:28<00:48, 12.72it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2054/2670 [03:28<00:37, 16.33it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2060/2670 [03:28<00:29, 20.69it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2066/2670 [03:28<00:23, 25.52it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2072/2670 [03:28<00:19, 30.56it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2078/2670 [03:29<00:16, 35.45it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2084/2670 [03:29<00:14, 39.84it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2090/2670 [03:29<00:13, 43.67it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2096/2670 [03:29<00:12, 46.86it/s]                                                    79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2100/2670 [03:29<00:12, 46.86it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2102/2670 [03:29<00:11, 49.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2108/2670 [03:29<00:10, 51.35it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2114/2670 [03:29<00:10, 52.95it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2120/2670 [03:29<00:10, 54.35it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2126/2670 [03:29<00:09, 54.78it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2132/2670 [03:30<00:10, 53.69it/s]{'eval_loss': 1.2381905317306519, 'eval_custom_error': 'Cannot extract labels from complex structure', 'eval_runtime': 15.4631, 'eval_samples_per_second': 0.388, 'eval_steps_per_second': 0.065, 'epoch': 7.49, 'timestamp': 1759689355.8428433, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8176, 'grad_norm': 0.12146887928247452, 'learning_rate': 0.0016213135999857183, 'epoch': 7.87, 'timestamp': 1759689357.6449986, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2138/2670 [03:46<07:23,  1.20it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2143/2670 [03:46<05:27,  1.61it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2149/2670 [03:46<03:46,  2.30it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2154/2670 [03:46<02:47,  3.09it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2159/2670 [03:46<02:02,  4.17it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2164/2670 [03:47<01:30,  5.61it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2169/2670 [03:47<01:06,  7.50it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2174/2670 [03:47<00:50,  9.89it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2179/2670 [03:47<00:38, 12.80it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2184/2670 [03:47<00:30, 16.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2189/2670 [03:47<00:24, 19.95it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2194/2670 [03:47<00:25, 18.73it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2199/2670 [03:48<00:20, 22.50it/s]                                                    82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2200/2670 [03:48<00:20, 22.50it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2204/2670 [03:48<00:17, 26.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2209/2670 [03:48<00:15, 29.91it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2214/2670 [03:48<00:13, 33.12it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2219/2670 [03:48<00:12, 35.83it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2224/2670 [03:48<00:11, 38.18it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2230/2670 [03:48<00:10, 42.12it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2236/2670 [03:48<00:09, 46.38it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2242/2670 [03:48<00:09, 47.01it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2248/2670 [03:49<00:08, 49.39it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2254/2670 [03:49<00:08, 51.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2260/2670 [03:49<00:07, 51.60it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2266/2670 [03:49<00:07, 52.32it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2272/2670 [03:49<00:07, 52.93it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2278/2670 [03:49<00:07, 53.57it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2284/2670 [03:49<00:07, 53.90it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2290/2670 [03:49<00:07, 54.15it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2296/2670 [03:49<00:06, 54.19it/s]                                                    86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2300/2670 [03:50<00:06, 54.19it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2302/2670 [03:50<00:06, 54.40it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2308/2670 [03:50<00:06, 54.47it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2314/2670 [03:50<00:06, 54.43it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2320/2670 [03:50<00:06, 54.47it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2326/2670 [03:50<00:06, 54.57it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2332/2670 [03:50<00:06, 54.46it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2338/2670 [03:50<00:06, 54.53it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2344/2670 [03:50<00:06, 54.33it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2350/2670 [03:50<00:05, 54.09it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2357/2670 [03:51<00:05, 56.30it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2363/2670 [03:51<00:05, 57.31it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2369/2670 [03:51<00:05, 56.33it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2375/2670 [03:51<00:05, 53.37it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2381/2670 [03:51<00:05, 53.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2387/2670 [03:51<00:05, 54.86it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2393/2670 [03:51<00:05, 54.50it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2399/2670 [03:51<00:05, 52.50it/s]                                                    90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2400/2670 [03:51<00:05, 52.50it/s]{'loss': 0.8227, 'grad_norm': 0.16075271368026733, 'learning_rate': 0.001605180457477188, 'epoch': 8.24, 'timestamp': 1759689376.2605445, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.816, 'grad_norm': 0.12071672827005386, 'learning_rate': 0.0015892078504056045, 'epoch': 8.61, 'timestamp': 1759689378.2078896, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8094, 'grad_norm': 0.14390820264816284, 'learning_rate': 0.0015733941813372047, 'epoch': 8.99, 'timestamp': 1759689380.0455148, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2405/2670 [04:09<03:51,  1.14it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2410/2670 [04:09<02:49,  1.54it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2416/2670 [04:09<01:55,  2.20it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2421/2670 [04:09<01:24,  2.95it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2426/2670 [04:09<01:01,  3.98it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2431/2670 [04:09<00:44,  5.37it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2436/2670 [04:09<00:32,  7.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2441/2670 [04:09<00:24,  9.51it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2446/2670 [04:10<00:18, 12.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2451/2670 [04:10<00:13, 15.69it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2456/2670 [04:10<00:11, 19.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2461/2670 [04:10<00:11, 18.29it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2466/2670 [04:10<00:09, 22.12it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2471/2670 [04:10<00:07, 26.08it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2476/2670 [04:11<00:08, 22.28it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2481/2670 [04:11<00:07, 26.12it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2486/2670 [04:11<00:06, 29.83it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2491/2670 [04:11<00:05, 33.16it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2496/2670 [04:11<00:04, 36.52it/s]                                                    94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2500/2670 [04:11<00:04, 36.52it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2501/2670 [04:11<00:04, 38.17it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2507/2670 [04:11<00:03, 42.17it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2514/2670 [04:11<00:03, 47.85it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2520/2670 [04:11<00:02, 50.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2527/2670 [04:12<00:02, 53.33it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2533/2670 [04:12<00:02, 53.25it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2539/2670 [04:12<00:02, 53.80it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2545/2670 [04:12<00:02, 54.28it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2551/2670 [04:12<00:02, 55.84it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2557/2670 [04:12<00:02, 54.96it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2563/2670 [04:12<00:01, 55.22it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2569/2670 [04:12<00:01, 55.70it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2575/2670 [04:12<00:01, 54.30it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2581/2670 [04:13<00:01, 53.97it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2587/2670 [04:13<00:01, 53.73it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2593/2670 [04:13<00:01, 53.44it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2599/2670 [04:13<00:01, 52.71it/s]                                                    97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2600/2670 [04:13<00:01, 52.71it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2605/2670 [04:13<00:01, 53.32it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2611/2670 [04:13<00:01, 52.74it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2617/2670 [04:13<00:01, 52.81it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2623/2670 [04:13<00:00, 53.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2629/2670 [04:13<00:00, 53.32it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2635/2670 [04:14<00:00, 53.89it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2641/2670 [04:14<00:00, 54.51it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2647/2670 [04:14<00:00, 55.34it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2653/2670 [04:14<00:00, 55.77it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2660/2670 [04:14<00:00, 57.28it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2666/2670 [04:14<00:00, 54.84it/s]Saving model checkpoint to /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2670
Configuration saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2670/config.json
Model weights saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2670/model.safetensors


Training completed. Do not forget to share your model on huggingface.co/models =)


Loading best model from /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_18-32-26/5min_patients/output/checkpoint-2000 (score: 1.2381905317306519).
                                                   100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670/2670 [04:15<00:00, 54.84it/s]
============================================================
TRAINING COMPLETED SUCCESSFULLY
Final train loss: 0.8225768776868613
Final eval loss: 1.2381905317306519
Best eval loss: 1.2381905317306519
Best checkpoint: checkpoint-2000
Training samples/second: 5329.018
============================================================
{'loss': 0.811, 'grad_norm': 0.13105034828186035, 'learning_rate': 0.0015577378687337523, 'epoch': 9.36, 'timestamp': 1759689399.829317, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8117, 'grad_norm': 0.13607586920261383, 'learning_rate': 0.0015422373467943583, 'epoch': 9.74, 'timestamp': 1759689401.649112, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'train_runtime': 255.882, 'train_samples_per_second': 5329.018, 'train_steps_per_second': 10.434, 'train_loss': 0.8225768776868613, 'epoch': 10.0, 'timestamp': 1759689404.0799549, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
[TrackingCallback] Mean Epoch Time = 25.586656785011293 seconds, Total Train Time = 255.88256788253784

============================================================
TRAINING COMPLETED SUCCESSFULLY
Final train loss: 0.8225768776868613
Final eval loss: 1.2381905317306519
Best eval loss: 1.2381905317306519
Best checkpoint: checkpoint-2000
Training samples/second: 5329.018
============================================================
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670/2670 [04:15<00:00, 10.43it/s]
INFO: [enhanced_info_print] [main] -------------------- Evaluating... -------------------- 

INFO: [enhanced_info_print] [main] ++++++++++++++++++++ Test MSE after few-shot 100% fine-tuning ++++++++++++++++++++

***** Running Evaluation *****
  Num examples = 14984
  Batch size = 512
  0%|          | 0/30 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 5/30 [00:00<00:00, 44.88it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 10/30 [00:00<00:00, 24.83it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 14/30 [00:00<00:00, 20.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 20/30 [00:00<00:00, 28.39it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 27/30 [00:00<00:00, 37.98it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30/30 [00:02<00:00, 13.03it/s]
INFO: [main] Training metrics saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915/training_metrics.json
{'eval_loss': 0.8172760605812073, 'eval_custom_error': 'Cannot extract labels from complex structure', 'eval_runtime': 17.1192, 'eval_samples_per_second': 875.274, 'eval_steps_per_second': 1.752, 'epoch': 10.0, 'timestamp': 1759689421.201472, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
METRICS_JSON:{"final_train_loss": 0.8225768776868613, "final_eval_loss": 0.8172760605812073, "best_eval_loss": 0.8172760605812073, "best_checkpoint": "checkpoint-2670", "training_samples_per_second": 5329.018}
Training finished at: 2025-10-05 18:37:02 UTC
Training exit code: 0
Total elapsed time: 0h 5m 3s (303 seconds)
Run completed. Logs and monitoring data saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915
Updating model registry with completion info...
Warning: Could not load metrics: name 'os' is not defined
Successfully loaded metrics from /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915/training_metrics.json
Updated registry for run: run_20251005_183159_job1354915 with status: completed
All run data and logs saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915
Configuration and results tracked in model registry
Moving SLURM output files to run directory...
Moved SLURM output file to /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915/
Moved SLURM error file to /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_183159_job1354915/
