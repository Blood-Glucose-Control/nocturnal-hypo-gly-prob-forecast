Using configuration file: models/configs/kaggle_batch_size_experiment/ttm_batch_size_512_experiment.yaml

=== Environment Check ===
Job started at: 2025-10-05 19:24:13 UTC
Job ID: 1354925
Node: watgpu608
Run Directory: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925
Virtual Environment source python path: /u6/cjrisi/nocturnal/.noctprob-venv/bin/python
Python Version: Python 3.11.4
Python internal path check: /u6/cjrisi/nocturnal/.noctprob-venv/bin/python

=== GPU Information ===
Sun Oct  5 19:24:13 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:04:00.0 Off |                    0 |
| N/A   31C    P8             33W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
GPU Driver Version: 575.57.08
GPU Name: NVIDIA L40S
GPU Memory: 46068 MiB
=====================================

=== Model Registry Initialization ===
Registering run in model registry...
Registered run: run_20251005_192407_job1354925

=== GPU Monitoring Log Setup ===
Starting GPU monitoring...
Started GPU monitoring (PID: 65575) and utilization logging (PID: 65576)

=== Starting Training ===
Training started at: 2025-10-05 19:24:14 UTC
Running command:
  python /u6/cjrisi/nocturnal/src/train/ttm_runner.py \
    --run-dir "/u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925"
    --config "/u6/cjrisi/nocturnal/models/configs/kaggle_batch_size_experiment/ttm_batch_size_512_experiment.yaml"

INFO: [main] =====================================
INFO: [main] === TTM Runner Starting ===
INFO: [main] Loading configuration from: /u6/cjrisi/nocturnal/models/configs/kaggle_batch_size_experiment/ttm_batch_size_512_experiment.yaml
INFO: [main] Configuration saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925/experiment_config.yaml
INFO: [main] =====================================
INFO: [main] === Calling finetune_ttm() ===
INFO: [enhanced_info_print] [main] -------------------- Preparing data... -------------------- 

INFO: [enhanced_info_print] [main] Found 9 processed CSV files in /u6/cjrisi/nocturnal/cache/data/kaggle_brisT1D/processed
INFO: [enhanced_info_print] [main] Loaded p10_full: 25803 rows
INFO: [enhanced_info_print] [main] Loaded p11_full: 25559 rows
INFO: [enhanced_info_print] [main] Loaded p01_full: 8711 rows
INFO: [enhanced_info_print] [main] Loaded p06_full: 8791 rows
INFO: [enhanced_info_print] [main] Loaded p05_full: 8808 rows
INFO: [enhanced_info_print] [main] Loaded p12_full: 26371 rows
INFO: [enhanced_info_print] [main] Loaded p02_full: 26423 rows
INFO: [enhanced_info_print] [main] Loaded p04_full: 24983 rows
INFO: [enhanced_info_print] [main] Loaded p03_full: 26423 rows
INFO: [enhanced_info_print] [main] Successfully loaded 9 patients
INFO: [enhanced_info_print] [main] Processing patient p10_full...
INFO: [enhanced_info_print] [main] Processing patient p11_full...
INFO: [enhanced_info_print] [main] Processing patient p12_full...
INFO: [enhanced_info_print] [main] Processing patient p02_full...
INFO: [enhanced_info_print] [main] Processing patient p04_full...
INFO: [enhanced_info_print] [main] Processing patient p03_full...
INFO: [enhanced_info_print] [main] Data length: 155562
INFO: [enhanced_info_print] [main] Split config: Train 90.0%, Test 10.0%
INFO: [enhanced_info_print] [main] Data ids: ['p10_full' 'p11_full' 'p12_full' 'p02_full' 'p04_full' 'p03_full']
INFO: [enhanced_info_print] [main] Data processing complete
INFO: [enhanced_info_print] [main] -------------------- Preparing model... -------------------- 

INFO: [enhanced_info_print] [main] Model path: ibm-granite/granite-timeseries-ttm-r2
INFO: [enhanced_info_print] [main] -------------------- Running few-shot 100% -------------------- 

2025-10-05T19:24:23 - Loading model from: ibm-granite/granite-timeseries-ttm-r2
2025-10-05T19:24:23 - Model loaded successfully from ibm-granite/granite-timeseries-ttm-r2, revision = main.
2025-10-05T19:24:23 - [TTM] context_length = 512, prediction_length = 96
INFO: [enhanced_info_print] [main] Using learning rate = 0.002
INFO: [enhanced_info_print] [main] Training for 10 epochs
Using auto half precision backend
INFO: [enhanced_info_print] [main] -------------------- Fine-tuning... -------------------- 

INFO: [enhanced_info_print] [main] Starting new training run in output directory: /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23
***** Running training *****
  Num examples = 136,360
  Num Epochs = 10
  Instantaneous batch size per device = 512
  Total train batch size (w. parallel, distributed & accumulation) = 512
  Gradient Accumulation steps = 1
  Total optimization steps = 2,670
  Number of trainable parameters = 289,696
Number of params before freezing backbone 805280
Number of params after freezing the backbone 289696
  0%|          | 0/2670 [00:00<?, ?it/s]  0%|          | 1/2670 [00:16<12:05:24, 16.31s/it]                                                     0%|          | 1/2670 [00:16<12:05:24, 16.31s/it]  0%|          | 8/2670 [00:16<1:06:21,  1.50s/it]   1%|          | 15/2670 [00:16<29:18,  1.51it/s]   1%|          | 21/2670 [00:16<17:39,  2.50it/s]  1%|          | 27/2670 [00:16<11:24,  3.86it/s]  1%|          | 33/2670 [00:16<07:44,  5.68it/s]  1%|â–         | 39/2670 [00:17<05:26,  8.06it/s]  2%|â–         | 45/2670 [00:17<03:57, 11.05it/s]  2%|â–         | 51/2670 [00:17<02:56, 14.81it/s]  2%|â–         | 57/2670 [00:17<02:15, 19.24it/s]  2%|â–         | 63/2670 [00:17<02:17, 18.94it/s]  3%|â–Ž         | 68/2670 [00:17<01:54, 22.66it/s]  3%|â–Ž         | 75/2670 [00:17<01:28, 29.16it/s]  3%|â–Ž         | 82/2670 [00:17<01:12, 35.54it/s]  3%|â–Ž         | 89/2670 [00:18<01:02, 41.03it/s]  4%|â–Ž         | 96/2670 [00:18<00:55, 46.28it/s]                                                   4%|â–Ž         | 100/2670 [00:18<00:55, 46.28it/s]  4%|â–         | 102/2670 [00:18<00:53, 48.25it/s]  4%|â–         | 109/2670 [00:18<00:49, 51.93it/s]  4%|â–         | 115/2670 [00:18<00:48, 53.03it/s]  5%|â–         | 121/2670 [00:18<00:47, 54.02it/s]  5%|â–         | 127/2670 [00:18<00:46, 54.83it/s]  5%|â–         | 133/2670 [00:18<00:45, 55.35it/s]  5%|â–Œ         | 139/2670 [00:18<00:45, 55.81it/s]  5%|â–Œ         | 145/2670 [00:19<00:45, 56.10it/s]  6%|â–Œ         | 151/2670 [00:19<00:44, 56.46it/s]  6%|â–Œ         | 157/2670 [00:19<00:44, 56.56it/s]  6%|â–Œ         | 163/2670 [00:19<00:44, 56.58it/s]  6%|â–‹         | 169/2670 [00:19<00:44, 56.69it/s]  7%|â–‹         | 175/2670 [00:19<00:44, 56.63it/s]  7%|â–‹         | 181/2670 [00:19<00:43, 56.61it/s]  7%|â–‹         | 187/2670 [00:19<00:43, 56.72it/s]  7%|â–‹         | 193/2670 [00:19<00:43, 56.54it/s]  7%|â–‹         | 199/2670 [00:20<00:43, 56.24it/s]                                                    7%|â–‹         | 200/2670 [00:20<00:43, 56.24it/s]  8%|â–Š         | 205/2670 [00:20<00:44, 55.89it/s]  8%|â–Š         | 211/2670 [00:20<00:43, 56.53it/s]  8%|â–Š         | 217/2670 [00:20<00:43, 55.84it/s]  8%|â–Š         | 223/2670 [00:20<00:45, 53.94it/s]  9%|â–Š         | 229/2670 [00:20<00:44, 54.62it/s]  9%|â–‰         | 235/2670 [00:20<00:45, 53.30it/s]  9%|â–‰         | 241/2670 [00:20<00:45, 53.07it/s]  9%|â–‰         | 247/2670 [00:20<00:44, 54.01it/s]  9%|â–‰         | 253/2670 [00:21<00:45, 52.83it/s] 10%|â–‰         | 259/2670 [00:21<00:48, 49.38it/s] 10%|â–‰         | 265/2670 [00:21<00:47, 50.57it/s]{'loss': 1.0695, 'grad_norm': 0.7027026414871216, 'learning_rate': 0.002, 'epoch': 0.0, 'timestamp': 1759692280.9723856, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8571, 'grad_norm': 0.11555618792772293, 'learning_rate': 0.0019802967070534504, 'epoch': 0.37, 'timestamp': 1759692282.9441411, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8339, 'grad_norm': 0.12177251279354095, 'learning_rate': 0.0019605914452309682, 'epoch': 0.75, 'timestamp': 1759692284.7034118, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 10%|â–ˆ         | 271/2670 [00:38<35:32,  1.13it/s] 10%|â–ˆ         | 276/2670 [00:38<26:20,  1.51it/s] 11%|â–ˆ         | 282/2670 [00:39<18:21,  2.17it/s] 11%|â–ˆ         | 287/2670 [00:39<13:35,  2.92it/s] 11%|â–ˆ         | 293/2670 [00:39<09:31,  4.16it/s] 11%|â–ˆ         | 298/2670 [00:39<07:07,  5.55it/s]                                                   11%|â–ˆ         | 300/2670 [00:39<07:06,  5.55it/s] 11%|â–ˆâ–        | 303/2670 [00:39<05:20,  7.39it/s] 12%|â–ˆâ–        | 308/2670 [00:39<04:01,  9.76it/s] 12%|â–ˆâ–        | 313/2670 [00:39<03:05, 12.70it/s] 12%|â–ˆâ–        | 318/2670 [00:39<02:25, 16.20it/s] 12%|â–ˆâ–        | 323/2670 [00:39<01:56, 20.07it/s] 12%|â–ˆâ–        | 328/2670 [00:39<01:36, 24.36it/s] 12%|â–ˆâ–        | 333/2670 [00:40<01:49, 21.40it/s] 13%|â–ˆâ–Ž        | 338/2670 [00:40<01:32, 25.17it/s] 13%|â–ˆâ–Ž        | 343/2670 [00:40<01:46, 21.86it/s] 13%|â–ˆâ–Ž        | 349/2670 [00:40<01:24, 27.34it/s] 13%|â–ˆâ–Ž        | 355/2670 [00:40<01:11, 32.18it/s] 14%|â–ˆâ–Ž        | 361/2670 [00:41<01:02, 36.77it/s] 14%|â–ˆâ–Ž        | 367/2670 [00:41<00:56, 40.53it/s] 14%|â–ˆâ–        | 373/2670 [00:41<00:52, 43.70it/s] 14%|â–ˆâ–        | 378/2670 [00:41<00:50, 44.98it/s] 14%|â–ˆâ–        | 384/2670 [00:41<00:48, 47.39it/s] 15%|â–ˆâ–        | 390/2670 [00:41<00:46, 49.00it/s] 15%|â–ˆâ–        | 396/2670 [00:41<00:45, 50.31it/s]                                                   15%|â–ˆâ–        | 400/2670 [00:41<00:45, 50.31it/s] 15%|â–ˆâ–Œ        | 402/2670 [00:41<00:44, 51.18it/s] 15%|â–ˆâ–Œ        | 408/2670 [00:41<00:43, 51.79it/s] 16%|â–ˆâ–Œ        | 414/2670 [00:42<00:43, 51.62it/s] 16%|â–ˆâ–Œ        | 420/2670 [00:42<00:43, 51.68it/s] 16%|â–ˆâ–Œ        | 426/2670 [00:42<00:43, 51.83it/s] 16%|â–ˆâ–Œ        | 432/2670 [00:42<00:43, 51.79it/s] 16%|â–ˆâ–‹        | 438/2670 [00:42<00:43, 51.69it/s] 17%|â–ˆâ–‹        | 444/2670 [00:42<00:43, 51.66it/s] 17%|â–ˆâ–‹        | 450/2670 [00:42<00:42, 51.63it/s] 17%|â–ˆâ–‹        | 456/2670 [00:42<00:42, 51.68it/s] 17%|â–ˆâ–‹        | 462/2670 [00:42<00:42, 51.66it/s] 18%|â–ˆâ–Š        | 468/2670 [00:43<00:43, 50.90it/s] 18%|â–ˆâ–Š        | 474/2670 [00:43<00:43, 50.23it/s] 18%|â–ˆâ–Š        | 480/2670 [00:43<00:44, 49.74it/s] 18%|â–ˆâ–Š        | 485/2670 [00:43<00:44, 49.56it/s] 18%|â–ˆâ–Š        | 490/2670 [00:43<00:44, 49.38it/s] 19%|â–ˆâ–Š        | 495/2670 [00:43<00:44, 49.28it/s] 19%|â–ˆâ–Š        | 500/2670 [00:43<00:44, 49.10it/s]                                                   19%|â–ˆâ–Š        | 500/2670 [00:43<00:44, 49.10it/s] 19%|â–ˆâ–‰        | 506/2670 [00:43<00:44, 48.97it/s] 19%|â–ˆâ–‰        | 512/2670 [00:43<00:43, 49.75it/s] 19%|â–ˆâ–‰        | 517/2670 [00:44<00:43, 49.75it/s] 20%|â–ˆâ–‰        | 523/2670 [00:44<00:42, 50.35it/s] 20%|â–ˆâ–‰        | 529/2670 [00:44<00:42, 50.29it/s]{'loss': 0.8346, 'grad_norm': 0.11232912540435791, 'learning_rate': 0.0019410822637948818, 'epoch': 1.12, 'timestamp': 1759692304.0330584, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8292, 'grad_norm': 0.11284457892179489, 'learning_rate': 0.0019217672116156727, 'epoch': 1.5, 'timestamp': 1759692306.418094, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8311, 'grad_norm': 0.12233947217464447, 'learning_rate': 0.001902644356978859, 'epoch': 1.87, 'timestamp': 1759692308.3913865, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 20%|â–ˆâ–ˆ        | 534/2670 [01:00<00:42, 50.29it/s] 20%|â–ˆâ–ˆ        | 535/2670 [01:01<31:37,  1.13it/s] 20%|â–ˆâ–ˆ        | 540/2670 [01:01<23:16,  1.53it/s] 20%|â–ˆâ–ˆ        | 545/2670 [01:01<16:59,  2.09it/s] 21%|â–ˆâ–ˆ        | 551/2670 [01:01<11:39,  3.03it/s] 21%|â–ˆâ–ˆ        | 557/2670 [01:01<08:10,  4.31it/s] 21%|â–ˆâ–ˆ        | 563/2670 [01:01<05:49,  6.03it/s] 21%|â–ˆâ–ˆâ–       | 569/2670 [01:01<04:13,  8.28it/s] 22%|â–ˆâ–ˆâ–       | 575/2670 [01:02<03:08, 11.13it/s] 22%|â–ˆâ–ˆâ–       | 581/2670 [01:02<02:23, 14.51it/s] 22%|â–ˆâ–ˆâ–       | 587/2670 [01:02<01:51, 18.75it/s] 22%|â–ˆâ–ˆâ–       | 593/2670 [01:02<01:29, 23.28it/s] 22%|â–ˆâ–ˆâ–       | 599/2670 [01:02<01:37, 21.32it/s]                                                   22%|â–ˆâ–ˆâ–       | 600/2670 [01:02<01:37, 21.32it/s] 23%|â–ˆâ–ˆâ–Ž       | 604/2670 [01:02<01:23, 24.67it/s] 23%|â–ˆâ–ˆâ–Ž       | 610/2670 [01:02<01:08, 29.87it/s] 23%|â–ˆâ–ˆâ–Ž       | 616/2670 [01:03<00:58, 35.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 622/2670 [01:03<00:51, 39.95it/s] 24%|â–ˆâ–ˆâ–Ž       | 628/2670 [01:03<00:46, 43.84it/s] 24%|â–ˆâ–ˆâ–Ž       | 634/2670 [01:03<00:45, 45.15it/s] 24%|â–ˆâ–ˆâ–       | 640/2670 [01:03<00:43, 47.12it/s] 24%|â–ˆâ–ˆâ–       | 646/2670 [01:03<00:40, 49.85it/s] 24%|â–ˆâ–ˆâ–       | 653/2670 [01:03<00:38, 52.12it/s] 25%|â–ˆâ–ˆâ–       | 659/2670 [01:03<00:40, 49.45it/s] 25%|â–ˆâ–ˆâ–       | 665/2670 [01:03<00:41, 48.48it/s] 25%|â–ˆâ–ˆâ–Œ       | 671/2670 [01:04<00:40, 49.89it/s] 25%|â–ˆâ–ˆâ–Œ       | 677/2670 [01:04<00:39, 50.88it/s] 26%|â–ˆâ–ˆâ–Œ       | 683/2670 [01:04<00:38, 52.05it/s] 26%|â–ˆâ–ˆâ–Œ       | 689/2670 [01:04<00:37, 52.75it/s] 26%|â–ˆâ–ˆâ–Œ       | 695/2670 [01:04<00:36, 53.80it/s]                                                   26%|â–ˆâ–ˆâ–Œ       | 700/2670 [01:04<00:36, 53.80it/s] 26%|â–ˆâ–ˆâ–‹       | 701/2670 [01:04<00:36, 54.38it/s] 26%|â–ˆâ–ˆâ–‹       | 707/2670 [01:04<00:35, 54.58it/s] 27%|â–ˆâ–ˆâ–‹       | 713/2670 [01:04<00:35, 55.45it/s] 27%|â–ˆâ–ˆâ–‹       | 719/2670 [01:04<00:35, 55.11it/s] 27%|â–ˆâ–ˆâ–‹       | 725/2670 [01:05<00:35, 54.41it/s] 27%|â–ˆâ–ˆâ–‹       | 731/2670 [01:05<00:34, 55.42it/s] 28%|â–ˆâ–ˆâ–Š       | 737/2670 [01:05<00:34, 55.57it/s] 28%|â–ˆâ–ˆâ–Š       | 743/2670 [01:05<00:34, 55.63it/s] 28%|â–ˆâ–ˆâ–Š       | 749/2670 [01:05<00:34, 55.58it/s] 28%|â–ˆâ–ˆâ–Š       | 755/2670 [01:05<00:34, 54.97it/s] 29%|â–ˆâ–ˆâ–Š       | 761/2670 [01:05<00:34, 56.03it/s] 29%|â–ˆâ–ˆâ–Š       | 767/2670 [01:05<00:34, 55.05it/s] 29%|â–ˆâ–ˆâ–‰       | 773/2670 [01:05<00:34, 55.35it/s] 29%|â–ˆâ–ˆâ–‰       | 779/2670 [01:06<00:33, 56.25it/s] 29%|â–ˆâ–ˆâ–‰       | 785/2670 [01:06<00:34, 55.04it/s] 30%|â–ˆâ–ˆâ–‰       | 791/2670 [01:06<00:34, 54.97it/s] 30%|â–ˆâ–ˆâ–‰       | 797/2670 [01:06<00:34, 54.91it/s]                                                   30%|â–ˆâ–ˆâ–‰       | 800/2670 [01:06<00:34, 54.91it/s]{'loss': 0.825, 'grad_norm': 0.12585577368736267, 'learning_rate': 0.0018837117873917895, 'epoch': 2.25, 'timestamp': 1759692327.40843, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8312, 'grad_norm': 0.138436421751976, 'learning_rate': 0.001864967609392383, 'epoch': 2.62, 'timestamp': 1759692329.2858298, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.828, 'grad_norm': 0.17331357300281525, 'learning_rate': 0.0018464099483597582, 'epoch': 3.0, 'timestamp': 1759692331.0787973, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 30%|â–ˆâ–ˆâ–ˆ       | 801/2670 [01:20<00:34, 54.91it/s] 30%|â–ˆâ–ˆâ–ˆ       | 802/2670 [01:23<28:06,  1.11it/s] 30%|â–ˆâ–ˆâ–ˆ       | 806/2670 [01:23<21:45,  1.43it/s] 30%|â–ˆâ–ˆâ–ˆ       | 811/2670 [01:23<15:35,  1.99it/s] 31%|â–ˆâ–ˆâ–ˆ       | 816/2670 [01:23<11:12,  2.76it/s] 31%|â–ˆâ–ˆâ–ˆ       | 821/2670 [01:23<08:03,  3.82it/s] 31%|â–ˆâ–ˆâ–ˆ       | 826/2670 [01:23<05:50,  5.26it/s] 31%|â–ˆâ–ˆâ–ˆ       | 831/2670 [01:23<04:17,  7.15it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 836/2670 [01:24<03:11,  9.59it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 842/2670 [01:24<02:18, 13.23it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 847/2670 [01:24<01:48, 16.74it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 854/2670 [01:24<01:18, 23.15it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 860/2670 [01:24<01:04, 28.02it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 866/2670 [01:24<01:17, 23.17it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 871/2670 [01:24<01:08, 26.21it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 876/2670 [01:25<01:03, 28.42it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 881/2670 [01:25<00:58, 30.69it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 886/2670 [01:25<00:51, 34.31it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 892/2670 [01:25<00:45, 39.21it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 897/2670 [01:25<00:42, 41.38it/s]                                                   34%|â–ˆâ–ˆâ–ˆâ–Ž      | 900/2670 [01:25<00:42, 41.38it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 902/2670 [01:25<00:40, 43.42it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 908/2670 [01:25<00:38, 45.96it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 913/2670 [01:25<00:37, 46.91it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 920/2670 [01:25<00:32, 53.08it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 926/2670 [01:26<00:33, 52.25it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 932/2670 [01:26<00:32, 54.05it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 938/2670 [01:26<00:31, 54.35it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 944/2670 [01:26<00:31, 55.36it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 950/2670 [01:26<00:30, 56.05it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 956/2670 [01:26<00:30, 56.89it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 962/2670 [01:26<00:29, 57.06it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 968/2670 [01:26<00:30, 56.34it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 974/2670 [01:26<00:30, 54.99it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 980/2670 [01:27<00:31, 54.48it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 986/2670 [01:27<00:31, 54.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 992/2670 [01:27<00:31, 53.01it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 998/2670 [01:27<00:31, 53.16it/s]                                                   37%|â–ˆâ–ˆâ–ˆâ–‹      | 1000/2670 [01:27<00:31, 53.16it/s]
***** Running Evaluation *****
  Num examples = 6
  Batch size = 512
{'loss': 0.8311, 'grad_norm': 0.12821504473686218, 'learning_rate': 0.001828036948326749, 'epoch': 3.37, 'timestamp': 1759692350.2877138, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8217, 'grad_norm': 0.18798241019248962, 'learning_rate': 0.001809846771794291, 'epoch': 3.75, 'timestamp': 1759692352.1061244, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 1000/2670 [01:40<00:31, 53.16it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A                                                   
                                     [A 37%|â–ˆâ–ˆâ–ˆâ–‹      | 1000/2670 [01:43<00:31, 53.16it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 1070.25it/s][A
                                               [A 37%|â–ˆâ–ˆâ–ˆâ–‹      | 1001/2670 [01:43<27:03,  1.03it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1006/2670 [01:43<19:10,  1.45it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1012/2670 [01:43<12:51,  2.15it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1018/2670 [01:44<08:49,  3.12it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 1024/2670 [01:44<06:09,  4.45it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 1030/2670 [01:44<04:23,  6.23it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1036/2670 [01:44<03:11,  8.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1042/2670 [01:44<02:21, 11.49it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1048/2670 [01:44<01:47, 15.08it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 1054/2670 [01:44<01:24, 19.18it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 1060/2670 [01:44<01:07, 23.75it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 1066/2670 [01:44<00:56, 28.54it/s]{'eval_loss': 1.2776600122451782, 'eval_custom_error': 'Cannot extract labels from complex structure', 'eval_runtime': 16.2132, 'eval_samples_per_second': 0.37, 'eval_steps_per_second': 0.062, 'epoch': 3.75, 'timestamp': 1759692368.3202102, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1068/2670 [02:00<00:56, 28.54it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1069/2670 [02:01<27:20,  1.02s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1074/2670 [02:01<19:22,  1.37it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1079/2670 [02:02<13:46,  1.92it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1084/2670 [02:02<09:51,  2.68it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1089/2670 [02:02<07:06,  3.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1094/2670 [02:02<05:11,  5.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1098/2670 [02:02<04:02,  6.47it/s]                                                    41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 1100/2670 [02:02<04:02,  6.47it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1103/2670 [02:02<02:57,  8.83it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1108/2670 [02:02<02:12, 11.82it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1113/2670 [02:02<01:41, 15.37it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1119/2670 [02:03<01:16, 20.38it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1125/2670 [02:03<00:59, 26.00it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1131/2670 [02:03<01:10, 21.70it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1136/2670 [02:03<01:02, 24.74it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1140/2670 [02:03<01:12, 21.07it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1144/2670 [02:04<01:04, 23.52it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1148/2670 [02:04<00:58, 25.97it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1152/2670 [02:04<00:53, 28.20it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1157/2670 [02:04<00:48, 31.50it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1163/2670 [02:04<00:41, 36.50it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1168/2670 [02:04<00:37, 39.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1173/2670 [02:04<00:36, 41.30it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1179/2670 [02:04<00:33, 44.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1186/2670 [02:04<00:28, 51.25it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1192/2670 [02:04<00:27, 52.92it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1198/2670 [02:05<00:29, 50.43it/s]                                                    45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1200/2670 [02:05<00:29, 50.43it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1204/2670 [02:05<00:29, 49.62it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1210/2670 [02:05<00:29, 48.77it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1215/2670 [02:05<00:29, 48.78it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1221/2670 [02:05<00:28, 51.02it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1229/2670 [02:05<00:25, 56.49it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1235/2670 [02:05<00:25, 57.34it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1242/2670 [02:05<00:23, 60.81it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1249/2670 [02:06<00:23, 60.10it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1256/2670 [02:06<00:23, 59.33it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1262/2670 [02:06<00:23, 58.93it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1268/2670 [02:06<00:25, 54.88it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1274/2670 [02:06<00:27, 51.45it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1280/2670 [02:06<00:26, 52.84it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1286/2670 [02:06<00:25, 53.95it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1293/2670 [02:06<00:24, 55.76it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1299/2670 [02:06<00:24, 56.72it/s]                                                    49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1300/2670 [02:06<00:24, 56.72it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1305/2670 [02:07<00:23, 57.42it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1311/2670 [02:07<00:23, 58.10it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1317/2670 [02:07<00:25, 53.88it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1323/2670 [02:07<00:24, 55.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1330/2670 [02:07<00:23, 56.76it/s]{'loss': 0.8194, 'grad_norm': 0.20800156891345978, 'learning_rate': 0.001791837599547652, 'epoch': 4.12, 'timestamp': 1759692387.3054335, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8248, 'grad_norm': 0.13796399533748627, 'learning_rate': 0.0017740076304744881, 'epoch': 4.49, 'timestamp': 1759692389.8357906, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8179, 'grad_norm': 0.1777573823928833, 'learning_rate': 0.0017563550813847147, 'epoch': 4.87, 'timestamp': 1759692391.6273966, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1335/2670 [02:20<00:23, 56.76it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1336/2670 [02:24<18:29,  1.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1341/2670 [02:24<13:50,  1.60it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1347/2670 [02:24<09:43,  2.27it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1353/2670 [02:24<06:53,  3.18it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1358/2670 [02:25<05:10,  4.22it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1364/2670 [02:25<03:41,  5.91it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1370/2670 [02:25<02:39,  8.13it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1376/2670 [02:25<01:58, 10.95it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1382/2670 [02:25<01:29, 14.37it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1388/2670 [02:25<01:09, 18.51it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1394/2670 [02:25<00:57, 22.29it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1399/2670 [02:26<01:04, 19.60it/s]                                                    52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1400/2670 [02:26<01:04, 19.60it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1403/2670 [02:26<00:57, 21.99it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1408/2670 [02:26<00:49, 25.74it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1414/2670 [02:26<00:41, 30.42it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1419/2670 [02:26<00:36, 34.20it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1424/2670 [02:26<00:33, 37.27it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1430/2670 [02:26<00:30, 41.01it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1435/2670 [02:26<00:28, 42.94it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1441/2670 [02:26<00:26, 47.21it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1447/2670 [02:27<00:25, 47.40it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1453/2670 [02:27<00:25, 47.17it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1459/2670 [02:27<00:24, 48.72it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1465/2670 [02:27<00:24, 49.90it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1471/2670 [02:27<00:23, 51.86it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1477/2670 [02:27<00:22, 52.47it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1483/2670 [02:27<00:21, 54.06it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1489/2670 [02:27<00:21, 54.04it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1495/2670 [02:27<00:21, 55.12it/s]                                                    56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1500/2670 [02:28<00:21, 55.12it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1501/2670 [02:28<00:21, 54.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1507/2670 [02:28<00:20, 55.65it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1513/2670 [02:28<00:20, 55.11it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1519/2670 [02:28<00:20, 55.72it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1525/2670 [02:28<00:20, 55.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1531/2670 [02:28<00:20, 55.35it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1537/2670 [02:28<00:20, 55.88it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1543/2670 [02:28<00:20, 55.35it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1549/2670 [02:28<00:20, 56.05it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1555/2670 [02:29<00:20, 55.17it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1561/2670 [02:29<00:19, 55.93it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1567/2670 [02:29<00:19, 55.44it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1573/2670 [02:29<00:19, 55.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1579/2670 [02:29<00:19, 55.19it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1585/2670 [02:29<00:19, 56.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1591/2670 [02:29<00:20, 52.49it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1597/2670 [02:29<00:20, 53.56it/s]                                                    60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1600/2670 [02:29<00:19, 53.56it/s]{'loss': 0.8239, 'grad_norm': 0.1417623907327652, 'learning_rate': 0.0017388781868321668, 'epoch': 5.24, 'timestamp': 1759692410.7893035, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8175, 'grad_norm': 0.12046767771244049, 'learning_rate': 0.0017215751989380385, 'epoch': 5.62, 'timestamp': 1759692412.749652, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8197, 'grad_norm': 0.16283243894577026, 'learning_rate': 0.0017044443872160726, 'epoch': 5.99, 'timestamp': 1759692414.5538886, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1602/2670 [02:40<00:19, 53.56it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1603/2670 [02:47<15:46,  1.13it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1607/2670 [02:47<12:20,  1.44it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1612/2670 [02:47<08:55,  1.98it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1617/2670 [02:47<06:26,  2.72it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1622/2670 [02:47<04:40,  3.74it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1627/2670 [02:47<03:22,  5.14it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1632/2670 [02:48<02:28,  6.98it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1638/2670 [02:48<01:44,  9.85it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1643/2670 [02:48<01:20, 12.77it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1649/2670 [02:48<00:59, 17.02it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1655/2670 [02:48<00:46, 21.69it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1661/2670 [02:48<00:37, 26.59it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1667/2670 [02:48<00:43, 23.32it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1672/2670 [02:49<00:48, 20.71it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1677/2670 [02:49<00:41, 24.08it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1683/2670 [02:49<00:33, 29.30it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1690/2670 [02:49<00:27, 35.70it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1696/2670 [02:49<00:24, 40.32it/s]                                                    64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1700/2670 [02:49<00:24, 40.32it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1703/2670 [02:49<00:21, 45.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1709/2670 [02:49<00:19, 48.41it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1715/2670 [02:50<00:19, 50.11it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1721/2670 [02:50<00:18, 52.58it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1729/2670 [02:50<00:16, 58.28it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1736/2670 [02:50<00:15, 59.85it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1743/2670 [02:50<00:15, 60.57it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1750/2670 [02:50<00:15, 61.27it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1757/2670 [02:50<00:15, 60.31it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1764/2670 [02:50<00:15, 58.22it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1770/2670 [02:50<00:15, 58.28it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1777/2670 [02:51<00:14, 60.75it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1784/2670 [02:51<00:14, 62.99it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1791/2670 [02:51<00:13, 63.52it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1798/2670 [02:51<00:14, 60.87it/s]                                                    67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1800/2670 [02:51<00:14, 60.87it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1805/2670 [02:51<00:14, 59.15it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1811/2670 [02:51<00:14, 58.80it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1818/2670 [02:51<00:14, 60.41it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1825/2670 [02:51<00:13, 61.29it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1832/2670 [02:51<00:13, 60.50it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1839/2670 [02:52<00:13, 60.43it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1846/2670 [02:52<00:15, 53.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1852/2670 [02:52<00:16, 49.54it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1858/2670 [02:52<00:17, 47.76it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1863/2670 [02:52<00:16, 47.57it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1869/2670 [02:53<01:00, 13.23it/s]{'loss': 0.8181, 'grad_norm': 0.14752233028411865, 'learning_rate': 0.001687484038399493, 'epoch': 6.37, 'timestamp': 1759692434.4151435, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8159, 'grad_norm': 0.2056359052658081, 'learning_rate': 0.0016706924562696636, 'epoch': 6.74, 'timestamp': 1759692436.0376685, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1873/2670 [03:09<12:25,  1.07it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1878/2670 [03:09<08:55,  1.48it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1884/2670 [03:09<06:02,  2.17it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1890/2670 [03:09<04:10,  3.12it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1896/2670 [03:10<02:55,  4.42it/s]                                                    71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1900/2670 [03:10<02:54,  4.42it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1902/2670 [03:10<02:04,  6.15it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1908/2670 [03:10<01:30,  8.45it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1914/2670 [03:10<01:06, 11.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1920/2670 [03:10<00:50, 14.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1926/2670 [03:10<00:39, 18.81it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1932/2670 [03:10<00:31, 23.28it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1938/2670 [03:11<00:34, 21.28it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1943/2670 [03:11<00:37, 19.30it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1948/2670 [03:11<00:31, 22.85it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1954/2670 [03:11<00:25, 27.81it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1959/2670 [03:11<00:22, 31.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1965/2670 [03:11<00:19, 36.31it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1971/2670 [03:11<00:17, 40.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1977/2670 [03:12<00:15, 43.84it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1983/2670 [03:12<00:15, 45.25it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1989/2670 [03:12<00:14, 47.37it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1996/2670 [03:12<00:13, 51.41it/s]                                                    75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 2000/2670 [03:12<00:13, 51.41it/s]
***** Running Evaluation *****
  Num examples = 6
  Batch size = 512
{'loss': 0.8143, 'grad_norm': 0.15787780284881592, 'learning_rate': 0.0016540679614864438, 'epoch': 7.12, 'timestamp': 1759692454.8203819, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8084, 'grad_norm': 0.13371087610721588, 'learning_rate': 0.001637608891420239, 'epoch': 7.49, 'timestamp': 1759692457.187951, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}

  0%|          | 0/1 [00:00<?, ?it/s][A                                                   
                                     [A 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 2000/2670 [03:28<00:13, 51.41it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 1105.80it/s][A
                                               [ASaving model checkpoint to /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2000
Configuration saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2000/config.json
Model weights saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2000/model.safetensors
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 2002/2670 [03:28<08:40,  1.28it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2006/2670 [03:28<06:48,  1.62it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2011/2670 [03:28<04:56,  2.22it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2016/2670 [03:28<03:34,  3.05it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2021/2670 [03:28<02:35,  4.17it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2026/2670 [03:28<01:53,  5.66it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 2031/2670 [03:28<01:23,  7.61it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2036/2670 [03:29<01:02, 10.07it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2041/2670 [03:29<00:48, 13.04it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2046/2670 [03:29<00:37, 16.46it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2052/2670 [03:29<00:28, 21.69it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2058/2670 [03:29<00:22, 27.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 2065/2670 [03:29<00:17, 33.77it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2072/2670 [03:29<00:14, 40.36it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2079/2670 [03:29<00:13, 44.98it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2085/2670 [03:29<00:12, 47.93it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2091/2670 [03:29<00:11, 50.70it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2097/2670 [03:30<00:10, 53.02it/s]                                                    79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 2100/2670 [03:30<00:10, 53.02it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2103/2670 [03:30<00:10, 54.72it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2109/2670 [03:30<00:10, 55.77it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2115/2670 [03:30<00:09, 56.86it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2121/2670 [03:30<00:09, 57.42it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2127/2670 [03:30<00:09, 57.90it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 2133/2670 [03:30<00:09, 56.63it/s]{'eval_loss': 1.2381905317306519, 'eval_custom_error': 'Cannot extract labels from complex structure', 'eval_runtime': 15.6026, 'eval_samples_per_second': 0.385, 'eval_steps_per_second': 0.064, 'epoch': 7.49, 'timestamp': 1759692472.7912276, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8176, 'grad_norm': 0.12146887928247452, 'learning_rate': 0.0016213135999857183, 'epoch': 7.87, 'timestamp': 1759692474.8040335, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2139/2670 [03:48<07:48,  1.13it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2144/2670 [03:48<05:45,  1.52it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2150/2670 [03:48<03:58,  2.18it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2156/2670 [03:48<02:46,  3.10it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2162/2670 [03:48<01:57,  4.34it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 2168/2670 [03:48<01:23,  6.01it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2174/2670 [03:48<01:00,  8.21it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2180/2670 [03:48<00:44, 11.01it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2186/2670 [03:49<00:33, 14.46it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2192/2670 [03:49<00:25, 18.61it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2198/2670 [03:49<00:25, 18.55it/s]                                                    82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2200/2670 [03:49<00:25, 18.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2203/2670 [03:49<00:21, 21.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2208/2670 [03:49<00:18, 24.78it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2214/2670 [03:49<00:15, 29.87it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2220/2670 [03:49<00:13, 34.59it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2226/2670 [03:50<00:11, 38.40it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 2232/2670 [03:50<00:10, 41.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2238/2670 [03:50<00:09, 44.59it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2244/2670 [03:50<00:09, 46.41it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2250/2670 [03:50<00:08, 47.85it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2256/2670 [03:50<00:08, 48.82it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2262/2670 [03:50<00:08, 49.54it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 2268/2670 [03:50<00:08, 49.98it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2274/2670 [03:51<00:07, 50.38it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2280/2670 [03:51<00:07, 50.57it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2286/2670 [03:51<00:07, 50.74it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2292/2670 [03:51<00:07, 50.93it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2298/2670 [03:51<00:07, 51.00it/s]                                                    86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2300/2670 [03:51<00:07, 51.00it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2304/2670 [03:51<00:07, 50.88it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2310/2670 [03:51<00:07, 51.00it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2316/2670 [03:51<00:06, 51.01it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2322/2670 [03:51<00:06, 51.07it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2328/2670 [03:52<00:06, 51.11it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2334/2670 [03:52<00:06, 50.82it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2340/2670 [03:52<00:06, 50.59it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2346/2670 [03:52<00:06, 52.74it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2352/2670 [03:52<00:06, 50.23it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2358/2670 [03:52<00:06, 49.66it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2363/2670 [03:52<00:06, 49.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2368/2670 [03:52<00:06, 48.84it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2373/2670 [03:52<00:06, 48.90it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2378/2670 [03:53<00:06, 48.33it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2383/2670 [03:53<00:05, 48.66it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2388/2670 [03:53<00:05, 48.38it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2395/2670 [03:53<00:05, 52.58it/s]                                                    90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2400/2670 [03:53<00:05, 52.58it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2402/2670 [03:53<00:04, 57.05it/s]{'loss': 0.8227, 'grad_norm': 0.16075271368026733, 'learning_rate': 0.001605180457477188, 'epoch': 8.24, 'timestamp': 1759692494.2042327, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.816, 'grad_norm': 0.12071672827005386, 'learning_rate': 0.0015892078504056045, 'epoch': 8.61, 'timestamp': 1759692496.1910355, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8094, 'grad_norm': 0.14390820264816284, 'learning_rate': 0.0015733941813372047, 'epoch': 8.99, 'timestamp': 1759692498.1453662, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2403/2670 [04:10<00:04, 57.05it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2404/2670 [04:10<04:44,  1.07s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2408/2670 [04:10<03:29,  1.25it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2414/2670 [04:10<02:12,  1.92it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2420/2670 [04:10<01:27,  2.86it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2426/2670 [04:11<00:59,  4.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2432/2670 [04:11<00:40,  5.82it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2437/2670 [04:11<00:30,  7.67it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2443/2670 [04:11<00:21, 10.52it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2449/2670 [04:11<00:15, 13.98it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2455/2670 [04:11<00:11, 18.02it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2461/2670 [04:11<00:11, 18.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2466/2670 [04:12<00:09, 21.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2471/2670 [04:12<00:07, 25.15it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2476/2670 [04:12<00:08, 22.10it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2481/2670 [04:12<00:07, 26.03it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2486/2670 [04:12<00:06, 29.81it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2491/2670 [04:12<00:05, 33.17it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2496/2670 [04:12<00:04, 36.18it/s]                                                    94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2500/2670 [04:12<00:04, 36.18it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2502/2670 [04:13<00:04, 41.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2508/2670 [04:13<00:03, 45.46it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2514/2670 [04:13<00:03, 48.99it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2520/2670 [04:13<00:02, 50.00it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2526/2670 [04:13<00:02, 50.47it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2532/2670 [04:13<00:02, 51.11it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2539/2670 [04:13<00:02, 54.19it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2545/2670 [04:13<00:02, 54.98it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2551/2670 [04:13<00:02, 54.55it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2557/2670 [04:14<00:02, 53.67it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2563/2670 [04:14<00:01, 53.76it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2569/2670 [04:14<00:01, 53.59it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2575/2670 [04:14<00:01, 53.46it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2581/2670 [04:14<00:01, 53.37it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2587/2670 [04:14<00:01, 53.16it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2593/2670 [04:14<00:01, 53.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2599/2670 [04:14<00:01, 53.82it/s]                                                    97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2600/2670 [04:14<00:01, 53.82it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2605/2670 [04:14<00:01, 53.96it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2611/2670 [04:15<00:01, 54.47it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2617/2670 [04:15<00:00, 54.59it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2623/2670 [04:15<00:00, 54.69it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2629/2670 [04:15<00:00, 54.58it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2635/2670 [04:15<00:00, 55.02it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2641/2670 [04:15<00:00, 55.22it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2647/2670 [04:15<00:00, 54.96it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2653/2670 [04:15<00:00, 55.42it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2659/2670 [04:15<00:00, 55.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2665/2670 [04:16<00:00, 54.61it/s]Saving model checkpoint to /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2670
Configuration saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2670/config.json
Model weights saved in /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2670/model.safetensors


Training completed. Do not forget to share your model on huggingface.co/models =)


Loading best model from /u6/cjrisi/nocturnal/models/ttm/kaggle_brisT1D/2025-10-05_19-24-23/5min_patients/output/checkpoint-2000 (score: 1.2381905317306519).
                                                   100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670/2670 [04:17<00:00, 54.61it/s]
============================================================
TRAINING COMPLETED SUCCESSFULLY
Final train loss: 0.8225768776868613
Final eval loss: 1.2381905317306519
Best eval loss: 1.2381905317306519
Best checkpoint: checkpoint-2000
Training samples/second: 5300.703
============================================================
{'loss': 0.811, 'grad_norm': 0.13105034828186035, 'learning_rate': 0.0015577378687337523, 'epoch': 9.36, 'timestamp': 1759692517.659693, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'loss': 0.8117, 'grad_norm': 0.13607586920261383, 'learning_rate': 0.0015422373467943583, 'epoch': 9.74, 'timestamp': 1759692519.4942977, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
{'train_runtime': 257.2489, 'train_samples_per_second': 5300.703, 'train_steps_per_second': 10.379, 'train_loss': 0.8225768776868613, 'epoch': 10.0, 'timestamp': 1759692521.911395, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
[TrackingCallback] Mean Epoch Time = 25.72393169403076 seconds, Total Train Time = 257.24914360046387

============================================================
TRAINING COMPLETED SUCCESSFULLY
Final train loss: 0.8225768776868613
Final eval loss: 1.2381905317306519
Best eval loss: 1.2381905317306519
Best checkpoint: checkpoint-2000
Training samples/second: 5300.703
============================================================
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2670/2670 [04:17<00:00, 10.38it/s]
INFO: [enhanced_info_print] [main] -------------------- Evaluating... -------------------- 

INFO: [enhanced_info_print] [main] ++++++++++++++++++++ Test MSE after few-shot 100% fine-tuning ++++++++++++++++++++

***** Running Evaluation *****
  Num examples = 14984
  Batch size = 512
  0%|          | 0/30 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 6/30 [00:00<00:00, 54.00it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 12/30 [00:00<00:00, 27.95it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 16/30 [00:00<00:00, 21.43it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 22/30 [00:00<00:00, 29.25it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 29/30 [00:00<00:00, 38.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30/30 [00:02<00:00, 12.87it/s]
INFO: [main] Training metrics saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925/training_metrics.json
{'eval_loss': 0.8172760605812073, 'eval_custom_error': 'Cannot extract labels from complex structure', 'eval_runtime': 17.0687, 'eval_samples_per_second': 877.866, 'eval_steps_per_second': 1.758, 'epoch': 10.0, 'timestamp': 1759692538.9815993, 'custom_batch_size': 512, 'custom_learning_rate': 0.002}
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
METRICS_JSON:{"final_train_loss": 0.8225768776868613, "final_eval_loss": 0.8172760605812073, "best_eval_loss": 0.8172760605812073, "best_checkpoint": "checkpoint-2670", "training_samples_per_second": 5300.703}
Training finished at: 2025-10-05 19:29:00 UTC
Training exit code: 0
Total elapsed time: 0h 4m 53s (293 seconds)
Run completed. Logs and monitoring data saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925
Updating model registry with completion info...
Warning: Could not load metrics: name 'os' is not defined
Successfully loaded metrics from /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925/training_metrics.json
Updated registry for run: run_20251005_192407_job1354925 with status: completed
All run data and logs saved to: /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925
Configuration and results tracked in model registry
Moving SLURM output files to run directory...
Moved SLURM output file to /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925/
Moved SLURM error file to /u6/cjrisi/nocturnal/results/runs/ttm_finetune/run_20251005_192407_job1354925/
